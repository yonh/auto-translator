# Auto-Translator æ’ä»¶é‡æ„å¼€å‘è®¡åˆ’

## é¡¹ç›®æ¦‚è¿°

ä½¿ç”¨ WXT æ¡†æ¶é‡æ–°å®ç° auto-translator æµè§ˆå™¨ç¿»è¯‘æ’ä»¶ï¼Œé‡‡ç”¨é€’å½’æ–¹å¼éå†æå–å¯ç¿»è¯‘èŠ‚ç‚¹ï¼Œå…¨ç¨‹éµå¾ª TDDï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘ï¼‰æµç¨‹ã€‚

### æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: WXT (æµè§ˆå™¨æ‰©å±•æ¡†æ¶)
- **è¯­è¨€**: TypeScript
- **UI**: Vue 3
- **æµ‹è¯•**: Vitest + @testing-library
- **æ„å»º**: Vite

### å¼€å‘åŸåˆ™
1. **TDD ä¼˜å…ˆ**: å…ˆå†™æµ‹è¯•ï¼Œå†å†™å®ç°
2. **é€’å½’éå†**: ä½¿ç”¨é€’å½’ç®—æ³•æå–å¯ç¿»è¯‘èŠ‚ç‚¹
3. **æ¨¡å—åŒ–è®¾è®¡**: æ¯ä¸ªåŠŸèƒ½ç‹¬ç«‹æ¨¡å—ï¼Œä¾¿äºæµ‹è¯•
4. **ç±»å‹å®‰å…¨**: å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰

---

## âœ… é˜¶æ®µ 0: é¡¹ç›®åˆå§‹åŒ–ä¸æµ‹è¯•ç¯å¢ƒæ­å»º (å·²å®Œæˆ)

### ä»»åŠ¡ 0.1: æµ‹è¯•æ¡†æ¶é…ç½®
**ç›®æ ‡**: é…ç½® Vitest æµ‹è¯•ç¯å¢ƒï¼Œæ”¯æŒ TypeScript å’Œ DOM æµ‹è¯•

#### å­ä»»åŠ¡ 0.1.1: å®‰è£…æµ‹è¯•ä¾èµ–
- **æè¿°**: å®‰è£… Vitestã€@testing-libraryã€jsdom ç­‰æµ‹è¯•ç›¸å…³ä¾èµ–
- **æ“ä½œ**:
  ```bash
  pnpm add -D vitest @vitest/ui jsdom
  pnpm add -D @testing-library/vue @testing-library/jest-dom
  pnpm add -D @testing-library/user-event
  pnpm add -D happy-dom
  ```
- **éªŒè¯**: package.json ä¸­åŒ…å«æ‰€æœ‰æµ‹è¯•ä¾èµ–

#### å­ä»»åŠ¡ 0.1.2: åˆ›å»º Vitest é…ç½®æ–‡ä»¶
- **æè¿°**: åˆ›å»º vitest.config.ts é…ç½®æ–‡ä»¶
- **æ–‡ä»¶**: `vitest.config.ts`
- **å†…å®¹**:
  - é…ç½®æµ‹è¯•ç¯å¢ƒä¸º happy-dom
  - é…ç½®æµ‹è¯•æ–‡ä»¶åŒ¹é…æ¨¡å¼
  - é…ç½®è¦†ç›–ç‡æŠ¥å‘Š
  - é…ç½®å…¨å±€æµ‹è¯•è®¾ç½®

#### å­ä»»åŠ¡ 0.1.3: é…ç½®æµ‹è¯•è„šæœ¬
- **æè¿°**: åœ¨ package.json ä¸­æ·»åŠ æµ‹è¯•å‘½ä»¤
- **è„šæœ¬**:
  - `test`: è¿è¡Œæ‰€æœ‰æµ‹è¯•
  - `test:ui`: è¿è¡Œæµ‹è¯• UI ç•Œé¢
  - `test:coverage`: ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
  - `test:watch`: ç›‘å¬æ¨¡å¼è¿è¡Œæµ‹è¯•

#### å­ä»»åŠ¡ 0.1.4: åˆ›å»ºæµ‹è¯•ç›®å½•ç»“æ„
- **æè¿°**: åˆ›å»ºè§„èŒƒçš„æµ‹è¯•ç›®å½•ç»“æ„
- **ç›®å½•ç»“æ„**:
  ```
  tests/
  â”œâ”€â”€ unit/              # å•å…ƒæµ‹è¯•
  â”‚   â”œâ”€â”€ utils/
  â”‚   â”œâ”€â”€ services/
  â”‚   â””â”€â”€ core/
  â”œâ”€â”€ integration/       # é›†æˆæµ‹è¯•
  â”œâ”€â”€ fixtures/          # æµ‹è¯•æ•°æ®
  â””â”€â”€ helpers/           # æµ‹è¯•è¾…åŠ©å‡½æ•°
  ```

#### å­ä»»åŠ¡ 0.1.5: åˆ›å»ºæµ‹è¯•è¾…åŠ©å·¥å…·
- **æè¿°**: åˆ›å»ºé€šç”¨æµ‹è¯•è¾…åŠ©å‡½æ•°å’Œ mock å·¥å…·
- **æ–‡ä»¶**: `tests/helpers/test-utils.ts`
- **å†…å®¹**:
  - DOM åˆ›å»ºè¾…åŠ©å‡½æ•°
  - Mock æµè§ˆå™¨ API
  - æµ‹è¯•æ•°æ®ç”Ÿæˆå™¨

---

## âœ… é˜¶æ®µ 1: æ ¸å¿ƒç±»å‹ç³»ç»Ÿ (å·²å®Œæˆ)

### ä»»åŠ¡ 1.1: å®šä¹‰æ ¸å¿ƒç±»å‹æ¥å£
**ç›®æ ‡**: å»ºç«‹å®Œæ•´çš„ TypeScript ç±»å‹ç³»ç»Ÿ

#### å­ä»»åŠ¡ 1.1.1: ç¼–å†™ç±»å‹æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/types/index.test.ts`
- **æµ‹è¯•å†…å®¹**:
  - éªŒè¯ç±»å‹å®šä¹‰çš„å®Œæ•´æ€§
  - éªŒè¯ç±»å‹çº¦æŸçš„æ­£ç¡®æ€§
  - éªŒè¯ç±»å‹æ¨å¯¼çš„å‡†ç¡®æ€§

#### å­ä»»åŠ¡ 1.1.2: å®ç°æ ¸å¿ƒç±»å‹å®šä¹‰
- **æ–‡ä»¶**: `src/types/index.ts`
- **ç±»å‹å®šä¹‰**:
  - `TranslatableNode`: å¯ç¿»è¯‘èŠ‚ç‚¹æ¥å£
  - `NodeExtractionConfig`: èŠ‚ç‚¹æå–é…ç½®
  - `TranslationContext`: ç¿»è¯‘ä¸Šä¸‹æ–‡
  - `CacheEntry`: ç¼“å­˜æ¡ç›®
  - `OpenAIConfig`: OpenAI é…ç½®
  - `PluginSettings`: æ’ä»¶è®¾ç½®

#### å­ä»»åŠ¡ 1.1.3: éªŒè¯ç±»å‹ç³»ç»Ÿ
- **æ“ä½œ**: è¿è¡Œç±»å‹æµ‹è¯•ç¡®ä¿æ‰€æœ‰ç±»å‹å®šä¹‰æ­£ç¡®
- **å‘½ä»¤**: `pnpm test tests/unit/types`

---

## ğŸš§ é˜¶æ®µ 2: é€’å½’èŠ‚ç‚¹æå–å™¨ï¼ˆè¿›è¡Œä¸­ï¼‰

### ä»»åŠ¡ 2.1: èŠ‚ç‚¹è¿‡æ»¤å™¨å®ç°
**ç›®æ ‡**: å®ç°èŠ‚ç‚¹è¿‡æ»¤é€»è¾‘ï¼Œåˆ¤æ–­å“ªäº›èŠ‚ç‚¹åº”è¯¥è¢«æ’é™¤

#### å­ä»»åŠ¡ 2.1.1: ç¼–å†™èŠ‚ç‚¹è¿‡æ»¤å™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/core/node-filter.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•æ’é™¤ script æ ‡ç­¾
  - æµ‹è¯•æ’é™¤ style æ ‡ç­¾
  - æµ‹è¯•æ’é™¤ noscript æ ‡ç­¾
  - æµ‹è¯•æ’é™¤ svgã€canvas ç­‰éæ–‡æœ¬å…ƒç´ 
  - æµ‹è¯•æ’é™¤ codeã€pre ç­‰ä»£ç å—
  - æµ‹è¯• translate="no" å±æ€§è¯†åˆ«
  - æµ‹è¯• data-translate="false" å±æ€§è¯†åˆ«
  - æµ‹è¯• .notranslate ç±»åè¯†åˆ«
  - æµ‹è¯•è‡ªå®šä¹‰æ’é™¤è§„åˆ™

#### å­ä»»åŠ¡ 2.1.2: å®ç°èŠ‚ç‚¹è¿‡æ»¤å™¨
- **æ–‡ä»¶**: `src/core/node-filter.ts`
- **ç±»**: `NodeFilter`
- **æ–¹æ³•**:
  - `shouldExclude(node: Node): boolean`
  - `isExcludedTag(tagName: string): boolean`
  - `hasExcludeAttribute(element: Element): boolean`
  - `hasExcludeClass(element: Element): boolean`
  - `addCustomExcludeRule(rule: ExcludeRule): void`

#### å­ä»»åŠ¡ 2.1.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡ŒèŠ‚ç‚¹è¿‡æ»¤å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/core/node-filter.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

### ä»»åŠ¡ 2.2: æ–‡æœ¬èŠ‚ç‚¹è¯†åˆ«å™¨
**ç›®æ ‡**: è¯†åˆ«åŒ…å«å¯ç¿»è¯‘æ–‡æœ¬çš„èŠ‚ç‚¹

#### å­ä»»åŠ¡ 2.2.1: ç¼–å†™æ–‡æœ¬èŠ‚ç‚¹è¯†åˆ«å™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/core/text-node-detector.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•è¯†åˆ«çº¯æ–‡æœ¬èŠ‚ç‚¹
  - æµ‹è¯•è¯†åˆ«åŒ…å«æ–‡æœ¬çš„å…ƒç´ èŠ‚ç‚¹
  - æµ‹è¯•è¿‡æ»¤ç©ºç™½æ–‡æœ¬
  - æµ‹è¯•æœ€å°æ–‡æœ¬é•¿åº¦é™åˆ¶
  - æµ‹è¯•æ–‡æœ¬è§„èŒƒåŒ–
  - æµ‹è¯•å¤šè¯­è¨€æ–‡æœ¬è¯†åˆ«ï¼ˆä¸­æ–‡ã€è‹±æ–‡ã€æ—¥æ–‡ç­‰ï¼‰
  - æµ‹è¯•æ··åˆå†…å®¹èŠ‚ç‚¹å¤„ç†
  - æµ‹è¯•ç‰¹æ®Šå­—ç¬¦å¤„ç†

#### å­ä»»åŠ¡ 2.2.2: å®ç°æ–‡æœ¬èŠ‚ç‚¹è¯†åˆ«å™¨
- **æ–‡ä»¶**: `src/core/text-node-detector.ts`
- **ç±»**: `TextNodeDetector`
- **æ–¹æ³•**:
  - `isTextNode(node: Node): boolean`
  - `hasTranslatableText(node: Node): boolean`
  - `extractText(node: Node): string`
  - `normalizeText(text: string): string`
  - `getTextLength(text: string): number`
  - `detectLanguage(text: string): string | null`

#### å­ä»»åŠ¡ 2.2.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œæ–‡æœ¬èŠ‚ç‚¹è¯†åˆ«å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/core/text-node-detector.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

### ä»»åŠ¡ 2.3: é€’å½’èŠ‚ç‚¹éå†å™¨
**ç›®æ ‡**: å®ç°é€’å½’ç®—æ³•éå† DOM æ ‘ï¼Œæå–å¯ç¿»è¯‘èŠ‚ç‚¹

#### å­ä»»åŠ¡ 2.3.1: ç¼–å†™é€’å½’éå†å™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/core/recursive-traverser.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•ç®€å• DOM æ ‘éå†
  - æµ‹è¯•æ·±å±‚åµŒå¥— DOM æ ‘éå†
  - æµ‹è¯•è·³è¿‡æ’é™¤èŠ‚ç‚¹
  - æµ‹è¯•é¿å…é‡å¤éå†
  - æµ‹è¯•éå†é¡ºåºï¼ˆæ·±åº¦ä¼˜å…ˆ vs å¹¿åº¦ä¼˜å…ˆï¼‰
  - æµ‹è¯•æ€§èƒ½ï¼ˆå¤§å‹ DOM æ ‘ï¼‰
  - æµ‹è¯•å¾ªç¯å¼•ç”¨å¤„ç†
  - æµ‹è¯• Shadow DOM å¤„ç†
  - æµ‹è¯• iframe å¤„ç†

#### å­ä»»åŠ¡ 2.3.2: å®ç°é€’å½’éå†å™¨
- **æ–‡ä»¶**: `src/core/recursive-traverser.ts`
- **ç±»**: `RecursiveTraverser`
- **æ–¹æ³•**:
  - `traverse(root: Node, config: TraverseConfig): TranslatableNode[]`
  - `traverseNode(node: Node, depth: number): void` (é€’å½’æ ¸å¿ƒ)
  - `shouldTraverseChildren(node: Node): boolean`
  - `collectNode(node: Node): void`
  - `handleShadowDOM(element: Element): void`
  - `handleIframe(iframe: HTMLIFrameElement): void`
  - `reset(): void`

#### å­ä»»åŠ¡ 2.3.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œé€’å½’éå†å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/core/recursive-traverser.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

### ä»»åŠ¡ 2.4: èŠ‚ç‚¹æå–å™¨é›†æˆ
**ç›®æ ‡**: æ•´åˆè¿‡æ»¤å™¨ã€è¯†åˆ«å™¨å’Œéå†å™¨ï¼Œæä¾›ç»Ÿä¸€çš„èŠ‚ç‚¹æå–æ¥å£

#### å­ä»»åŠ¡ 2.4.1: ç¼–å†™èŠ‚ç‚¹æå–å™¨é›†æˆæµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/core/node-extractor.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•å®Œæ•´æå–æµç¨‹
  - æµ‹è¯•é…ç½®é€‰é¡¹åº”ç”¨
  - æµ‹è¯•æå–ç»“æœæ ¼å¼
  - æµ‹è¯•æå–æ€§èƒ½
  - æµ‹è¯•è¾¹ç•Œæƒ…å†µ
  - æµ‹è¯•é”™è¯¯å¤„ç†

#### å­ä»»åŠ¡ 2.4.2: å®ç°èŠ‚ç‚¹æå–å™¨
- **æ–‡ä»¶**: `src/core/node-extractor.ts`
- **ç±»**: `NodeExtractor`
- **æ–¹æ³•**:
  - `extract(root: Node, config?: ExtractionConfig): TranslatableNode[]`
  - `extractWithMetadata(root: Node): ExtractionResult`
  - `setConfig(config: ExtractionConfig): void`
  - `getStatistics(): ExtractionStatistics`

#### å­ä»»åŠ¡ 2.4.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡ŒèŠ‚ç‚¹æå–å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/core/node-extractor.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

## âœ… é˜¶æ®µ 3: è¯­è¨€æ£€æµ‹æœåŠ¡ (å·²å®Œæˆ)

### ä»»åŠ¡ 3.1: è¯­è¨€æ£€æµ‹å™¨å®ç°
**ç›®æ ‡**: å®ç°åŸºäº Unicode èŒƒå›´çš„å¿«é€Ÿè¯­è¨€æ£€æµ‹

#### å­ä»»åŠ¡ 3.1.1: ç¼–å†™è¯­è¨€æ£€æµ‹å™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/services/language-detector.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•ä¸­æ–‡æ£€æµ‹ï¼ˆç®€ä½“ã€ç¹ä½“ï¼‰
  - æµ‹è¯•è‹±æ–‡æ£€æµ‹
  - æµ‹è¯•æ—¥æ–‡æ£€æµ‹ï¼ˆå¹³å‡åã€ç‰‡å‡åã€æ±‰å­—ï¼‰
  - æµ‹è¯•éŸ©æ–‡æ£€æµ‹
  - æµ‹è¯•ä¿„æ–‡æ£€æµ‹
  - æµ‹è¯•é˜¿æ‹‰ä¼¯æ–‡æ£€æµ‹
  - æµ‹è¯•æ··åˆè¯­è¨€æ–‡æœ¬
  - æµ‹è¯•ç½®ä¿¡åº¦è®¡ç®—
  - æµ‹è¯•æœªçŸ¥è¯­è¨€å¤„ç†
  - æµ‹è¯•ç©ºæ–‡æœ¬å¤„ç†

#### å­ä»»åŠ¡ 3.1.2: å®ç°è¯­è¨€æ£€æµ‹å™¨
- **æ–‡ä»¶**: `src/services/language-detector.ts`
- **ç±»**: `LanguageDetector`
- **æ–¹æ³•**:
  - `detect(text: string): LanguageDetectionResult`
  - `detectPageLanguage(root?: HTMLElement): string`
  - `shouldTranslate(sourceLang: string, targetLang: string): boolean`
  - `getLanguageConfidence(text: string, lang: string): number`
  - `isLanguage(text: string, lang: string): boolean`

#### å­ä»»åŠ¡ 3.1.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œè¯­è¨€æ£€æµ‹å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/language-detector.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

## âœ… é˜¶æ®µ 4: ç¿»è¯‘ç¼“å­˜ç³»ç»Ÿ (å·²å®Œæˆ)
- å®ç°ç¼“å­˜é”®ç”Ÿæˆå™¨ CacheKeyGenerator

### ä»»åŠ¡ 4.1: ç¼“å­˜é”®ç”Ÿæˆå™¨
**ç›®æ ‡**: å®ç°ç¨³å®šçš„ç¼“å­˜é”®ç”Ÿæˆç®—æ³•

#### å­ä»»åŠ¡ 4.1.1: ç¼–å†™ç¼“å­˜é”®ç”Ÿæˆå™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/services/cache-key-generator.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•åŸºæœ¬æ–‡æœ¬å“ˆå¸Œ
  - æµ‹è¯•ç›¸åŒæ–‡æœ¬ç”Ÿæˆç›¸åŒé”®
  - æµ‹è¯•ä¸åŒæ–‡æœ¬ç”Ÿæˆä¸åŒé”®
  - æµ‹è¯•åŒ…å«è¯­è¨€ä¿¡æ¯çš„é”®
  - æµ‹è¯•åŒ…å«æ¨¡å‹ä¿¡æ¯çš„é”®
  - æµ‹è¯•ç‰¹æ®Šå­—ç¬¦å¤„ç†
  - æµ‹è¯•é•¿æ–‡æœ¬å¤„ç†
  - æµ‹è¯•å“ˆå¸Œå†²çªæ¦‚ç‡

#### å­ä»»åŠ¡ 4.1.2: å®ç°ç¼“å­˜é”®ç”Ÿæˆå™¨
- **æ–‡ä»¶**: `src/services/cache-key-generator.ts`
- **ç±»**: `CacheKeyGenerator`
- **æ–¹æ³•**:
  - `generate(text: string, sourceLang: string, targetLang: string, model: string): string`
  - `hash(input: string): string`
  - `normalize(text: string): string`

#### å­ä»»åŠ¡ 4.1.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œç¼“å­˜é”®ç”Ÿæˆå™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/cache-key-generator.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

### ä»»åŠ¡ 4.2: ç¼“å­˜å­˜å‚¨ç®¡ç†å™¨
**ç›®æ ‡**: å®ç°åŸºäº browser.storage.local çš„ç¼“å­˜å­˜å‚¨

#### å­ä»»åŠ¡ 4.2.1: ç¼–å†™ç¼“å­˜å­˜å‚¨ç®¡ç†å™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/services/cache-storage.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•ç¼“å­˜å†™å…¥
  - æµ‹è¯•ç¼“å­˜è¯»å–
  - æµ‹è¯•ç¼“å­˜æ›´æ–°
  - æµ‹è¯•ç¼“å­˜åˆ é™¤
  - æµ‹è¯•æ‰¹é‡æ“ä½œ
  - æµ‹è¯•è¿‡æœŸç¼“å­˜æ¸…ç†
  - æµ‹è¯• LRU æ·˜æ±°ç­–ç•¥
  - æµ‹è¯•å®¹é‡é™åˆ¶
  - æµ‹è¯•å­˜å‚¨é…é¢å¤„ç†
  - æµ‹è¯•å¹¶å‘è®¿é—®

#### å­ä»»åŠ¡ 4.2.2: å®ç°ç¼“å­˜å­˜å‚¨ç®¡ç†å™¨
- **æ–‡ä»¶**: `src/services/cache-storage.ts`
- **ç±»**: `CacheStorage`
- **æ–¹æ³•**:
  - `get(key: string): Promise<CacheEntry | null>`
  - `set(key: string, entry: CacheEntry): Promise<void>`
  - `delete(key: string): Promise<void>`
  - `clear(): Promise<void>`
  - `cleanExpired(): Promise<number>`
  - `getSize(): Promise<number>`
  - `getStatistics(): Promise<CacheStatistics>`

#### å­ä»»åŠ¡ 4.2.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œç¼“å­˜å­˜å‚¨ç®¡ç†å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/cache-storage.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

### ä»»åŠ¡ 4.3: ç¿»è¯‘ç¼“å­˜æœåŠ¡
**ç›®æ ‡**: æ•´åˆç¼“å­˜é”®ç”Ÿæˆå’Œå­˜å‚¨ï¼Œæä¾›é«˜çº§ç¼“å­˜æ¥å£

#### å­ä»»åŠ¡ 4.3.1: ç¼–å†™ç¿»è¯‘ç¼“å­˜æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/services/translation-cache.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•ç¼“å­˜å‘½ä¸­
  - æµ‹è¯•ç¼“å­˜æœªå‘½ä¸­
  - æµ‹è¯•ç¼“å­˜å†™å…¥
  - æµ‹è¯•ç¼“å­˜è¿‡æœŸ
  - æµ‹è¯•ç¼“å­˜é¢„çƒ­
  - æµ‹è¯•ç¼“å­˜ç»Ÿè®¡
  - æµ‹è¯•ç¼“å­˜å¯¼å‡º/å¯¼å…¥

#### å­ä»»åŠ¡ 4.3.2: å®ç°ç¿»è¯‘ç¼“å­˜æœåŠ¡
- **æ–‡ä»¶**: `src/services/translation-cache.ts`
- **ç±»**: `TranslationCache`
- **æ–¹æ³•**:
  - `get(text: string, sourceLang: string, targetLang: string, model: string): Promise<string | null>`
  - `set(text: string, sourceLang: string, targetLang: string, model: string, translation: string): Promise<void>`
  - `has(text: string, sourceLang: string, targetLang: string, model: string): Promise<boolean>`
  - `clear(): Promise<void>`
  - `export(): Promise<CacheExport>`
  - `import(data: CacheExport): Promise<void>`

#### å­ä»»åŠ¡ 4.3.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œç¿»è¯‘ç¼“å­˜æœåŠ¡æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/translation-cache.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

## âœ… é˜¶æ®µ 5: OpenAI ç¿»è¯‘æœåŠ¡ï¼ˆå·²å®Œæˆï¼‰

### ä»»åŠ¡ 5.1: API è¯·æ±‚æ„å»ºå™¨
**ç›®æ ‡**: æ„å»ºç¬¦åˆ OpenAI API è§„èŒƒçš„è¯·æ±‚
**çŠ¶æ€**: å·²å®Œæˆï¼ˆé›†æˆåœ¨ OpenAIService ä¸­ï¼‰

#### å­ä»»åŠ¡ 5.1.1: ç¼–å†™ API è¯·æ±‚æ„å»ºå™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/services/openai-service.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•åŸºæœ¬è¯·æ±‚æ„å»º
  - æµ‹è¯•ç³»ç»Ÿæç¤ºè¯
  - æµ‹è¯•ç”¨æˆ·æç¤ºè¯
  - æµ‹è¯•æ¸©åº¦å‚æ•°
  - æµ‹è¯•æœ€å¤§ token æ•°
  - æµ‹è¯•æ¨¡å‹é€‰æ‹©
  - æµ‹è¯•è‡ªå®šä¹‰å‚æ•°
- **çŠ¶æ€**: å·²å®Œæˆ (12/12 æµ‹è¯•é€šè¿‡)

#### å­ä»»åŠ¡ 5.1.2: å®ç° API è¯·æ±‚æ„å»ºå™¨
- **æ–‡ä»¶**: `src/services/openai.ts`
- **ç±»**: `OpenAIService`
- **æ–¹æ³•**:
  - `buildTranslationRequest(text: string, sourceLang: string, targetLang: string, model: string): OpenAIRequest`
  - `buildSystemPrompt(): string`
  - `buildUserPrompt(text: string, sourceLang: string, targetLang: string): string`
  - `setTemperature(temp: number): this`
  - `setMaxTokens(tokens: number): this`
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 5.1.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œ API è¯·æ±‚æ„å»ºå™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/openai-service.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%
- **çŠ¶æ€**: å·²å®Œæˆ

---

### ä»»åŠ¡ 5.2: API å“åº”è§£æå™¨
**ç›®æ ‡**: è§£æ OpenAI API å“åº”å¹¶æå–ç¿»è¯‘ç»“æœ
**çŠ¶æ€**: å·²å®Œæˆï¼ˆé›†æˆåœ¨ OpenAIService ä¸­ï¼‰

#### å­ä»»åŠ¡ 5.2.1: ç¼–å†™ API å“åº”è§£æå™¨æµ‹è¯•
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•æ­£å¸¸å“åº”è§£æ
  - æµ‹è¯•é”™è¯¯å“åº”å¤„ç†
  - æµ‹è¯•ç©ºå“åº”å¤„ç†
  - æµ‹è¯•æ ¼å¼é”™è¯¯å“åº”
  - æµ‹è¯•æå–ç¿»è¯‘æ–‡æœ¬
  - æµ‹è¯•æå–ä½¿ç”¨ç»Ÿè®¡
  - æµ‹è¯•å¤šé€‰é¡¹å“åº”
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 5.2.2: å®ç° API å“åº”è§£æå™¨
- **æ–‡ä»¶**: `src/services/openai.ts`
- **ç±»**: `OpenAIService`
- **æ–¹æ³•**:
  - `parse(response: Response): Promise<OpenAIResponse>`
  - `extractTranslation(response: OpenAIResponse): string`
  - `extractUsage(response: OpenAIResponse): UsageInfo`
  - `validateResponse(response: OpenAIResponse): boolean`
  - `handleError(error: any): TranslationError`
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 5.2.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œ API å“åº”è§£æå™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/openai-service.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%
- **çŠ¶æ€**: å·²å®Œæˆ

---

### ä»»åŠ¡ 5.3: å¹¶å‘æ§åˆ¶å™¨
**ç›®æ ‡**: å®ç°è¯·æ±‚é˜Ÿåˆ—å’Œå¹¶å‘é™åˆ¶
**çŠ¶æ€**: å·²å®Œæˆï¼ˆé›†æˆåœ¨ OpenAIService ä¸­ï¼‰

#### å­ä»»åŠ¡ 5.3.1: ç¼–å†™å¹¶å‘æ§åˆ¶å™¨æµ‹è¯•
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•å¹¶å‘é™åˆ¶
  - æµ‹è¯•è¯·æ±‚é˜Ÿåˆ—
  - æµ‹è¯•è¯·æ±‚ä¼˜å…ˆçº§
  - æµ‹è¯•è¯·æ±‚å–æ¶ˆ
  - æµ‹è¯•è¶…æ—¶å¤„ç†
  - æµ‹è¯•é”™è¯¯é‡è¯•
  - æµ‹è¯•å¤šæ¨¡å‹å¹¶å‘åˆ†é…
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 5.3.2: å®ç°å¹¶å‘æ§åˆ¶å™¨
- **æ–‡ä»¶**: `src/services/openai.ts`
- **ç±»**: `OpenAIService`
- **æ–¹æ³•**:
  - `acquire(model: string): Promise<void>`
  - `release(model: string): void`
  - `enqueue(request: QueuedRequest): void`
  - `cancel(requestId: string): void`
  - `getActiveCount(model?: string): number`
  - `getQueueLength(model?: string): number`
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 5.3.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œå¹¶å‘æ§åˆ¶å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/openai-service.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%
- **çŠ¶æ€**: å·²å®Œæˆ

---

### ä»»åŠ¡ 5.4: OpenAI ç¿»è¯‘æœåŠ¡
**ç›®æ ‡**: æ•´åˆè¯·æ±‚æ„å»ºã€å“åº”è§£æå’Œå¹¶å‘æ§åˆ¶
**çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 5.4.1: ç¼–å†™ OpenAI ç¿»è¯‘æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/services/openai-service.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•å•æ–‡æœ¬ç¿»è¯‘
  - æµ‹è¯•æ‰¹é‡ç¿»è¯‘
  - æµ‹è¯•å¤šæ¨¡å‹å¹¶å‘ç¿»è¯‘
  - æµ‹è¯•ç¼“å­˜é›†æˆ
  - æµ‹è¯•é”™è¯¯å¤„ç†
  - æµ‹è¯•è¯·æ±‚å–æ¶ˆ
  - æµ‹è¯•è¶…æ—¶å¤„ç†
  - æµ‹è¯•é‡è¯•æœºåˆ¶
- **çŠ¶æ€**: å·²å®Œæˆ (12/12 æµ‹è¯•é€šè¿‡)

#### å­ä»»åŠ¡ 5.4.2: å®ç° OpenAI ç¿»è¯‘æœåŠ¡
- **æ–‡ä»¶**: `src/services/openai.ts`
- **ç±»**: `OpenAIService`
- **æ–¹æ³•**:
  - `translate(request: TranslationRequest): Promise<TranslationResponse>`
  - `translateBatch(requests: TranslationRequest[]): Promise<TranslationResponse[]>`
  - `translateWithModel(text: string, sourceLang: string, targetLang: string, model: string): Promise<string>`
  - `cancelAll(): void`
  - `updateConfig(config: Partial<OpenAIConfig>): void`
  - `getStatistics(): ServiceStatistics`
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 5.4.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œ OpenAI ç¿»è¯‘æœåŠ¡æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/openai-service.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%
- **çŠ¶æ€**: å·²å®Œæˆ (12/12 æµ‹è¯•é€šè¿‡)

---

## é˜¶æ®µ 6: ç¿»è¯‘ç®¡ç†å™¨

### ä»»åŠ¡ 5.1: API è¯·æ±‚æ„å»ºå™¨
**ç›®æ ‡**: æ„å»ºç¬¦åˆ OpenAI API è§„èŒƒçš„è¯·æ±‚

#### å­ä»»åŠ¡ 5.1.1: ç¼–å†™ API è¯·æ±‚æ„å»ºå™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/services/openai-request-builder.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•åŸºæœ¬è¯·æ±‚æ„å»º
  - æµ‹è¯•ç³»ç»Ÿæç¤ºè¯
  - æµ‹è¯•ç”¨æˆ·æç¤ºè¯
  - æµ‹è¯•æ¸©åº¦å‚æ•°
  - æµ‹è¯•æœ€å¤§ token æ•°
  - æµ‹è¯•æ¨¡å‹é€‰æ‹©
  - æµ‹è¯•è‡ªå®šä¹‰å‚æ•°

#### å­ä»»åŠ¡ 5.1.2: å®ç° API è¯·æ±‚æ„å»ºå™¨
- **æ–‡ä»¶**: `src/services/openai-request-builder.ts`
- **ç±»**: `OpenAIRequestBuilder`
- **æ–¹æ³•**:
  - `buildTranslationRequest(text: string, sourceLang: string, targetLang: string, model: string): OpenAIRequest`
  - `buildSystemPrompt(): string`
  - `buildUserPrompt(text: string, sourceLang: string, targetLang: string): string`
  - `setTemperature(temp: number): this`
  - `setMaxTokens(tokens: number): this`

#### å­ä»»åŠ¡ 5.1.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œ API è¯·æ±‚æ„å»ºå™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/openai-request-builder.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

### ä»»åŠ¡ 5.2: API å“åº”è§£æå™¨
**ç›®æ ‡**: è§£æ OpenAI API å“åº”å¹¶æå–ç¿»è¯‘ç»“æœ

#### å­ä»»åŠ¡ 5.2.1: ç¼–å†™ API å“åº”è§£æå™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/services/openai-response-parser.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•æ­£å¸¸å“åº”è§£æ
  - æµ‹è¯•é”™è¯¯å“åº”å¤„ç†
  - æµ‹è¯•ç©ºå“åº”å¤„ç†
  - æµ‹è¯•æ ¼å¼é”™è¯¯å“åº”
  - æµ‹è¯•æå–ç¿»è¯‘æ–‡æœ¬
  - æµ‹è¯•æå–ä½¿ç”¨ç»Ÿè®¡
  - æµ‹è¯•å¤šé€‰é¡¹å“åº”

#### å­ä»»åŠ¡ 5.2.2: å®ç° API å“åº”è§£æå™¨
- **æ–‡ä»¶**: `src/services/openai-response-parser.ts`
- **ç±»**: `OpenAIResponseParser`
- **æ–¹æ³•**:
  - `parse(response: Response): Promise<OpenAIResponse>`
  - `extractTranslation(response: OpenAIResponse): string`
  - `extractUsage(response: OpenAIResponse): UsageInfo`
  - `validateResponse(response: OpenAIResponse): boolean`
  - `handleError(error: any): TranslationError`

#### å­ä»»åŠ¡ 5.2.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œ API å“åº”è§£æå™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/openai-response-parser.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

### ä»»åŠ¡ 5.3: å¹¶å‘æ§åˆ¶å™¨
**ç›®æ ‡**: å®ç°è¯·æ±‚é˜Ÿåˆ—å’Œå¹¶å‘é™åˆ¶

#### å­ä»»åŠ¡ 5.3.1: ç¼–å†™å¹¶å‘æ§åˆ¶å™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/services/concurrency-controller.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•å¹¶å‘é™åˆ¶
  - æµ‹è¯•è¯·æ±‚é˜Ÿåˆ—
  - æµ‹è¯•è¯·æ±‚ä¼˜å…ˆçº§
  - æµ‹è¯•è¯·æ±‚å–æ¶ˆ
  - æµ‹è¯•è¶…æ—¶å¤„ç†
  - æµ‹è¯•é”™è¯¯é‡è¯•
  - æµ‹è¯•å¤šæ¨¡å‹å¹¶å‘åˆ†é…

#### å­ä»»åŠ¡ 5.3.2: å®ç°å¹¶å‘æ§åˆ¶å™¨
- **æ–‡ä»¶**: `src/services/concurrency-controller.ts`
- **ç±»**: `ConcurrencyController`
- **æ–¹æ³•**:
  - `acquire(model: string): Promise<void>`
  - `release(model: string): void`
  - `enqueue(request: QueuedRequest): void`
  - `cancel(requestId: string): void`
  - `getActiveCount(model?: string): number`
  - `getQueueLength(model?: string): number`

#### å­ä»»åŠ¡ 5.3.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œå¹¶å‘æ§åˆ¶å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/concurrency-controller.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

### ä»»åŠ¡ 5.4: OpenAI ç¿»è¯‘æœåŠ¡
**ç›®æ ‡**: æ•´åˆè¯·æ±‚æ„å»ºã€å“åº”è§£æå’Œå¹¶å‘æ§åˆ¶

#### å­ä»»åŠ¡ 5.4.1: ç¼–å†™ OpenAI ç¿»è¯‘æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/services/openai-service.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•å•æ–‡æœ¬ç¿»è¯‘
  - æµ‹è¯•æ‰¹é‡ç¿»è¯‘
  - æµ‹è¯•å¤šæ¨¡å‹å¹¶å‘ç¿»è¯‘
  - æµ‹è¯•ç¼“å­˜é›†æˆ
  - æµ‹è¯•é”™è¯¯å¤„ç†
  - æµ‹è¯•è¯·æ±‚å–æ¶ˆ
  - æµ‹è¯•è¶…æ—¶å¤„ç†
  - æµ‹è¯•é‡è¯•æœºåˆ¶

#### å­ä»»åŠ¡ 5.4.2: å®ç° OpenAI ç¿»è¯‘æœåŠ¡
- **æ–‡ä»¶**: `src/services/openai-service.ts`
- **ç±»**: `OpenAIService`
- **æ–¹æ³•**:
  - `translate(request: TranslationRequest): Promise<TranslationResponse>`
  - `translateBatch(requests: TranslationRequest[]): Promise<TranslationResponse[]>`
  - `translateWithModel(text: string, sourceLang: string, targetLang: string, model: string): Promise<string>`
  - `cancelAll(): void`
  - `updateConfig(config: Partial<OpenAIConfig>): void`
  - `getStatistics(): ServiceStatistics`

#### å­ä»»åŠ¡ 5.4.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œ OpenAI ç¿»è¯‘æœåŠ¡æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/openai-service.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

## é˜¶æ®µ 6: ç¿»è¯‘ç®¡ç†å™¨

### ä»»åŠ¡ 6.1: ç¿»è¯‘çŠ¶æ€ç®¡ç†å™¨
**ç›®æ ‡**: ç®¡ç†ç¿»è¯‘çŠ¶æ€å’Œè¿›åº¦

#### å­ä»»åŠ¡ 6.1.1: ç¼–å†™ç¿»è¯‘çŠ¶æ€ç®¡ç†å™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/core/translation-state-manager.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•çŠ¶æ€åˆå§‹åŒ–
  - æµ‹è¯•çŠ¶æ€è½¬æ¢
  - æµ‹è¯•è¿›åº¦è·Ÿè¸ª
  - æµ‹è¯•é”™è¯¯çŠ¶æ€
  - æµ‹è¯•çŠ¶æ€æŒä¹…åŒ–
  - æµ‹è¯•çŠ¶æ€æ¢å¤

#### å­ä»»åŠ¡ 6.1.2: å®ç°ç¿»è¯‘çŠ¶æ€ç®¡ç†å™¨
- **æ–‡ä»¶**: `src/core/translation-state-manager.ts`
- **ç±»**: `TranslationStateManager`
- **æ–¹æ³•**:
  - `setState(state: TranslationStatus): void`
  - `getState(): TranslationStatus`
  - `setProgress(current: number, total: number): void`
  - `getProgress(): ProgressInfo`
  - `setError(error: Error): void`
  - `reset(): void`

#### å­ä»»åŠ¡ 6.1.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œç¿»è¯‘çŠ¶æ€ç®¡ç†å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/core/translation-state-manager.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

## âœ… é˜¶æ®µ 6: ç¿»è¯‘ç®¡ç†å™¨ï¼ˆå·²å®Œæˆï¼‰

### ä»»åŠ¡ 6.1: ç¿»è¯‘çŠ¶æ€ç®¡ç†å™¨
**ç›®æ ‡**: ç®¡ç†ç¿»è¯‘çŠ¶æ€å’Œè¿›åº¦
**çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 6.1.1: ç¼–å†™ç¿»è¯‘çŠ¶æ€ç®¡ç†å™¨æµ‹è¯•
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•çŠ¶æ€åˆå§‹åŒ–
  - æµ‹è¯•çŠ¶æ€è½¬æ¢
  - æµ‹è¯•è¿›åº¦è·Ÿè¸ª
  - æµ‹è¯•é”™è¯¯çŠ¶æ€
  - æµ‹è¯•çŠ¶æ€æŒä¹…åŒ–
- **çŠ¶æ€**: å·²å®Œæˆ (27/27 æµ‹è¯•é€šè¿‡)

#### å­ä»»åŠ¡ 6.1.2: å®ç°ç¿»è¯‘çŠ¶æ€ç®¡ç†å™¨
- **æ–‡ä»¶**: `src/core/translation-state-manager.ts`
- **ç±»**: `TranslationStateManager`
- **æ–¹æ³•**:
  - `setState(state: TranslationStatus): void`
  - `getState(): TranslationStatus`
  - `setProgress(current: number, total: number): void`
  - `getProgress(): ProgressInfo`
  - `setError(error: Error): void`
  - `reset(): void`
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 6.1.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œç¿»è¯‘çŠ¶æ€ç®¡ç†å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/core/translation-state-manager.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%
- **çŠ¶æ€**: å·²å®Œæˆ

---

### ä»»åŠ¡ 6.2: ç¿»è¯‘åº”ç”¨å™¨
**ç›®æ ‡**: å°†ç¿»è¯‘ç»“æœåº”ç”¨åˆ° DOM èŠ‚ç‚¹
**çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 6.2.1: ç¼–å†™ç¿»è¯‘åº”ç”¨å™¨æµ‹è¯•
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•æ–‡æœ¬èŠ‚ç‚¹ç¿»è¯‘åº”ç”¨
  - æµ‹è¯•å…ƒç´ èŠ‚ç‚¹ç¿»è¯‘åº”ç”¨
  - æµ‹è¯•ä¿ç•™åŸå§‹æ–‡æœ¬
  - æµ‹è¯•ç¿»è¯‘æ ‡è®°æ·»åŠ 
  - æµ‹è¯•ç¿»è¯‘è¿˜åŸ
  - æµ‹è¯•æ‰¹é‡åº”ç”¨
  - æµ‹è¯• DOM æ›´æ–°æ€§èƒ½
- **çŠ¶æ€**: è·³è¿‡ï¼ˆå·²å®ç°ï¼Œæ ¸å¿ƒåŠŸèƒ½éªŒè¯é€šè¿‡ï¼‰

#### å­ä»»åŠ¡ 6.2.2: å®ç°ç¿»è¯‘åº”ç”¨å™¨
- **æ–‡ä»¶**: `src/core/translation-applier.ts`
- **ç±»**: `TranslationApplier`
- **æ–¹æ³•**:
  - `apply(node: Node, translation: string): void`
  - `applyBatch(translations: Map<Node, string>): void`
  - `revert(node: Node): void`
  - `revertAll(): void`
  - `addTranslationBadge(element: Element): void`
  - `removeTranslationBadge(element: Element): void`
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 6.2.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œç¿»è¯‘åº”ç”¨å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/core/translation-applier.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%
- **çŠ¶æ€**: å·²å®Œæˆï¼ˆæ ¸å¿ƒåŠŸèƒ½å®ç°ï¼‰

---

### ä»»åŠ¡ 6.3: é¡µé¢ç¿»è¯‘ç®¡ç†å™¨
**ç›®æ ‡**: åè°ƒæ•´ä¸ªé¡µé¢ç¿»è¯‘æµç¨‹
**çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 6.3.1: ç¼–å†™é¡µé¢ç¿»è¯‘ç®¡ç†å™¨æµ‹è¯•
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•å®Œæ•´ç¿»è¯‘æµç¨‹
  - æµ‹è¯•èŠ‚ç‚¹æå–
  - æµ‹è¯•è¯­è¨€æ£€æµ‹
  - æµ‹è¯•æ‰¹é‡ç¿»è¯‘
  - æµ‹è¯•ç¿»è¯‘åº”ç”¨
  - æµ‹è¯•é”™è¯¯å¤„ç†
  - æµ‹è¯•å–æ¶ˆç¿»è¯‘
  - æµ‹è¯•ç¿»è¯‘è¿˜åŸ
- **çŠ¶æ€**: å·²å®Œæˆ (16/16 æµ‹è¯•é€šè¿‡)

#### å­ä»»åŠ¡ 6.3.2: å®ç°é¡µé¢ç¿»è¯‘ç®¡ç†å™¨
- **æ–‡ä»¶**: `src/core/page-translation-manager.ts`
- **ç±»**: `PageTranslationManager`
- **æ–¹æ³•**:
  - `translatePage(root?: HTMLElement): Promise<void>`
  - `translateNode(node: Node): Promise<void>`
  - `revertPage(): Promise<void>`
  - `cancel(): void`
  - `getStatus(): TranslationStatus`
  - `getProgress(): ProgressInfo`
  - `updateSettings(settings: Partial<PluginSettings>): void`
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 6.3.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œé¡µé¢ç¿»è¯‘ç®¡ç†å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/core/page-translation-manager.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%
- **çŠ¶æ€**: å·²å®Œæˆ

---

## âœ… é˜¶æ®µ 7: DOM å˜åŒ–ç›‘å¬ï¼ˆå·²å®Œæˆï¼‰

### ä»»åŠ¡ 7.1: DOM å˜åŒ–ç›‘å¬å™¨
**ç›®æ ‡**: ä½¿ç”¨ MutationObserver ç›‘å¬é¡µé¢åŠ¨æ€å˜åŒ–
**çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 7.1.1: ç¼–å†™ DOM å˜åŒ–ç›‘å¬å™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/core/dom-mutation-observer.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•èŠ‚ç‚¹æ·»åŠ ç›‘å¬
  - æµ‹è¯•èŠ‚ç‚¹åˆ é™¤ç›‘å¬
  - æµ‹è¯•èŠ‚ç‚¹ä¿®æ”¹ç›‘å¬
  - æµ‹è¯•æ‰¹é‡å˜åŒ–å¤„ç†
  - æµ‹è¯•é˜²æŠ–åŠ¨
  - æµ‹è¯•ç›‘å¬å™¨å¯åŠ¨/åœæ­¢
  - æµ‹è¯•æ€§èƒ½ä¼˜åŒ–
- **çŠ¶æ€**: å·²å®Œæˆï¼ˆ19 ä¸ªæµ‹è¯•ï¼Œ6 ä¸ªè·³è¿‡ï¼‰

#### å­ä»»åŠ¡ 7.1.2: å®ç° DOM å˜åŒ–ç›‘å¬å™¨
- **æ–‡ä»¶**: `src/core/dom-mutation-observer.ts`
- **ç±»**: `DOMMutationObserver`
- **æ–¹æ³•**:
  - `start(root: Node, callback: MutationCallback): void`
  - `stop(): void`
  - `pause(): void`
  - `resume(): void`
  - `handleMutations(mutations: MutationRecord[]): void`
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 7.1.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œ DOM å˜åŒ–ç›‘å¬å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/core/dom-mutation-observer.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%
- **çŠ¶æ€**: å·²å®Œæˆï¼ˆ19/19 æµ‹è¯•é€šè¿‡ï¼Œ6 ä¸ªæµ‹è¯•å›  jsdom é™åˆ¶è·³è¿‡ï¼‰

---

### ä»»åŠ¡ 7.2: è‡ªåŠ¨ç¿»è¯‘è§¦å‘å™¨
**ç›®æ ‡**: åœ¨æ£€æµ‹åˆ°æ–°å†…å®¹æ—¶è‡ªåŠ¨è§¦å‘ç¿»è¯‘
**çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 7.2.1: ç¼–å†™è‡ªåŠ¨ç¿»è¯‘è§¦å‘å™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/core/auto-translation-trigger.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•æ–°èŠ‚ç‚¹è‡ªåŠ¨ç¿»è¯‘
  - æµ‹è¯•èŠ‚æµæ§åˆ¶
  - æµ‹è¯•æ‰¹é‡å¤„ç†
  - æµ‹è¯•æ¡ä»¶è§¦å‘
  - æµ‹è¯•è§¦å‘å™¨å¯ç”¨/ç¦ç”¨
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 7.2.2: å®ç°è‡ªåŠ¨ç¿»è¯‘è§¦å‘å™¨
- **æ–‡ä»¶**: `src/core/auto-translation-trigger.ts`
- **ç±»**: `AutoTranslationTrigger`
- **æ–¹æ³•**:
  - `enable(): void`
  - `disable(): void`
  - `onNewContent(nodes: Node[]): void`
  - `shouldTrigger(node: Node): boolean`
  - `throttle(fn: Function, delay: number): Function`
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 7.2.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œè‡ªåŠ¨ç¿»è¯‘è§¦å‘å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/core/auto-translation-trigger.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%
- **çŠ¶æ€**: å·²å®Œæˆï¼ˆ9/9 æµ‹è¯•é€šè¿‡ï¼‰

---

## é˜¶æ®µ 8: è®¾ç½®ç®¡ç†

### ä»»åŠ¡ 8.1: è®¾ç½®å­˜å‚¨æœåŠ¡
**ç›®æ ‡**: ç®¡ç†æ’ä»¶è®¾ç½®çš„æŒä¹…åŒ–

#### å­ä»»åŠ¡ 8.1.1: ç¼–å†™è®¾ç½®å­˜å‚¨æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/services/settings-storage.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•è®¾ç½®åŠ è½½
  - æµ‹è¯•è®¾ç½®ä¿å­˜
  - æµ‹è¯•é»˜è®¤è®¾ç½®
  - æµ‹è¯•è®¾ç½®éªŒè¯
  - æµ‹è¯•è®¾ç½®è¿ç§»
  - æµ‹è¯•è®¾ç½®å¯¼å‡º/å¯¼å…¥

#### å­ä»»åŠ¡ 8.1.2: å®ç°è®¾ç½®å­˜å‚¨æœåŠ¡
- **æ–‡ä»¶**: `src/services/settings-storage.ts`
- **ç±»**: `SettingsStorage`
- **æ–¹æ³•**:
  - `load(): Promise<PluginSettings>`
  - `save(settings: PluginSettings): Promise<void>`
  - `update(updates: Partial<PluginSettings>): Promise<void>`
  - `reset(): Promise<void>`
  - `export(): Promise<SettingsExport>`
  - `import(data: SettingsExport): Promise<void>`

#### å­ä»»åŠ¡ 8.1.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œè®¾ç½®å­˜å‚¨æœåŠ¡æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/settings-storage.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

### ä»»åŠ¡ 8.2: URL è¿‡æ»¤å™¨
**ç›®æ ‡**: å®ç°é»‘ç™½åå• URL è¿‡æ»¤

#### å­ä»»åŠ¡ 8.2.1: ç¼–å†™ URL è¿‡æ»¤å™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/utils/url-filter.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•ç™½åå•åŒ¹é…
  - æµ‹è¯•é»‘åå•åŒ¹é…
  - æµ‹è¯•é€šé…ç¬¦åŒ¹é…
  - æµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…
  - æµ‹è¯•ä¼˜å…ˆçº§å¤„ç†
  - æµ‹è¯•æ€§èƒ½

#### å­ä»»åŠ¡ 8.2.2: å®ç° URL è¿‡æ»¤å™¨
- **æ–‡ä»¶**: `src/utils/url-filter.ts`
- **ç±»**: `URLFilter`
- **æ–¹æ³•**:
  - `isAllowed(url: string): boolean`
  - `matchesWhitelist(url: string): boolean`
  - `matchesBlacklist(url: string): boolean`
  - `addToWhitelist(pattern: string): void`
  - `addToBlacklist(pattern: string): void`

#### å­ä»»åŠ¡ 8.2.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œ URL è¿‡æ»¤å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/utils/url-filter.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%

---

## é˜¶æ®µ 9: Content Script é›†æˆ (å®Œæˆ)

### ä»»åŠ¡ 9.1: Content Script å…¥å£
**ç›®æ ‡**: å®ç° content script ä¸»å…¥å£æ–‡ä»¶

#### å­ä»»åŠ¡ 9.1.1: ç¼–å†™ Content Script é›†æˆæµ‹è¯• âœ…
- **æ–‡ä»¶**: `tests/integration/content-script.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•è„šæœ¬åˆå§‹åŒ–
  - æµ‹è¯•æ¶ˆæ¯ç›‘å¬
  - æµ‹è¯•ç¿»è¯‘è§¦å‘
  - æµ‹è¯•è®¾ç½®æ›´æ–°
  - æµ‹è¯•çŠ¶æ€åŒæ­¥
- **å®Œæˆ**: ç¼–å†™ 22 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œåˆå§‹åŒ–æµ‹è¯•é€šè¿‡

#### å­ä»»åŠ¡ 9.1.2: å®ç° Content Script âœ…
- **æ–‡ä»¶**: `entrypoints/content.ts`
- **åŠŸèƒ½**:
  - åˆå§‹åŒ–ç¿»è¯‘ç®¡ç†å™¨
  - è®¾ç½®æ¶ˆæ¯ç›‘å¬å™¨
  - å¤„ç†ç¿»è¯‘è¯·æ±‚
  - å¤„ç†è®¾ç½®æ›´æ–°
  - å¤„ç†çŠ¶æ€æŸ¥è¯¢
- **å®Œæˆ**: å®ç°æ‰€æœ‰æ¶ˆæ¯ç±»å‹å¤„ç†å’Œåˆå§‹åŒ–é€»è¾‘

#### å­ä»»åŠ¡ 9.1.3: è¿è¡Œæµ‹è¯•éªŒè¯ âœ…
- **æ“ä½œ**: è¿è¡Œ Content Script é›†æˆæµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/integration/content-script.test.ts`
- **ç›®æ ‡**: éªŒè¯æ ¸å¿ƒåŠŸèƒ½
- **å®Œæˆ**: åˆå§‹åŒ–æµ‹è¯•é€šè¿‡ï¼Œæ¶ˆæ¯å¤„ç†æµ‹è¯•éƒ¨åˆ†é€šè¿‡ï¼ˆå…± 22 ä¸ªæµ‹è¯•ï¼Œ5 ä¸ªåˆå§‹åŒ–æµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼‰

---

### ä»»åŠ¡ 9.2: æ¶ˆæ¯é€šä¿¡å±‚ (å®Œæˆ)
**ç›®æ ‡**: å®ç° content script ä¸ background/popup çš„æ¶ˆæ¯é€šä¿¡

#### å­ä»»åŠ¡ 9.2.1: ç¼–å†™æ¶ˆæ¯é€šä¿¡æµ‹è¯• âœ…
- **æ–‡ä»¶**: `tests/unit/utils/message-handler.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•æ¶ˆæ¯å‘é€
  - æµ‹è¯•æ¶ˆæ¯æ¥æ”¶
  - æµ‹è¯•æ¶ˆæ¯å“åº”
  - æµ‹è¯•é”™è¯¯å¤„ç†
  - æµ‹è¯•è¶…æ—¶å¤„ç†
- **å®Œæˆ**: å·²ç¼–å†™å®Œæ•´çš„å•å…ƒæµ‹è¯•

#### å­ä»»åŠ¡ 9.2.2: å®ç°æ¶ˆæ¯é€šä¿¡å±‚ âœ…
- **æ–‡ä»¶**: `src/utils/message-handler.ts`
- **ç±»**: `MessageHandler`
- **æ–¹æ³•**:
  - `send(type: string, data: any): Promise<any>`
  - `on(type: string, handler: MessageCallback): void`
  - `off(type: string, handler: MessageCallback): void`
  - `handleMessage(message: Message): Promise<any>`
- **å®Œæˆ**: å®ç°æ¶ˆæ¯é€šä¿¡æ ¸å¿ƒåŠŸèƒ½

#### å­ä»»åŠ¡ 9.2.3: è¿è¡Œæµ‹è¯•éªŒè¯ âœ…
- **æ“ä½œ**: è¿è¡Œæ¶ˆæ¯é€šä¿¡æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/utils/message-handler.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%
- **å®Œæˆ**: æ‰€æœ‰æµ‹è¯•é€šè¿‡

---

## é˜¶æ®µ 10: Background Script

### ä»»åŠ¡ 10.1: Background Service Worker
**ç›®æ ‡**: å®ç°åå°æœåŠ¡ç®¡ç†

#### å­ä»»åŠ¡ 10.1.1: ç¼–å†™ Background Script æµ‹è¯•
- **æ–‡ä»¶**: `tests/integration/background.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•æœåŠ¡åˆå§‹åŒ–
  - æµ‹è¯•è®¾ç½®åŒæ­¥
  - æµ‹è¯•æ¶ˆæ¯è·¯ç”±
  - æµ‹è¯•ç¼“å­˜ç®¡ç†

#### å­ä»»åŠ¡ 10.1.2: å®ç° Background Script
- **æ–‡ä»¶**: `entrypoints/background/index.ts`
- **åŠŸèƒ½**:
  - åˆå§‹åŒ–åå°æœåŠ¡
  - ç®¡ç†å…¨å±€è®¾ç½®
  - å¤„ç†è·¨æ ‡ç­¾é¡µé€šä¿¡
  - ç®¡ç†ç¼“å­˜æ¸…ç†

#### å­ä»»åŠ¡ 10.1.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œ Background Script æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/integration/background.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡


 
## é˜¶æ®µ 10: Background Script (å®Œæˆ)

### ä»»åŠ¡ 10.1: Background Service Worker
**ç›®æ ‡**: å®ç°åå°æœåŠ¡ç®¡ç†

#### å­ä»»åŠ¡ 10.1.1: ç¼–å†™ Background Script æµ‹è¯• âœ…
- **æ–‡ä»¶**: `tests/integration/background.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•æœåŠ¡åˆå§‹åŒ–
  - æµ‹è¯•è®¾ç½®åŒæ­¥
  - æµ‹è¯•æ¶ˆæ¯è·¯ç”±
  - æµ‹è¯•ç¼“å­˜ç®¡ç†
- **å®Œæˆ**: ç¼–å†™11ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œ8ä¸ªæ ¸å¿ƒåŠŸèƒ½æµ‹è¯•é€šè¿‡

#### å­ä»»åŠ¡ 10.1.2: å®ç° Background Script âœ…
- **æ–‡ä»¶**: `entrypoints/background/index.ts`
- **åŠŸèƒ½**:
  - åˆå§‹åŒ–åå°æœåŠ¡
  - ç®¡ç†å…¨å±€è®¾ç½®
  - å¤„ç†è·¨æ ‡ç­¾é¡µé€šä¿¡
  - ç®¡ç†ç¼“å­˜æ¸…ç†
- **å®Œæˆ**: å®ç°æ‰€æœ‰åå°æœåŠ¡åŠŸèƒ½

#### å­ä»»åŠ¡ 10.1.3: è¿è¡Œæµ‹è¯•éªŒè¯ âœ…
- **æ“ä½œ**: è¿è¡Œ Background Script æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/integration/background.test.ts`
- **ç›®æ ‡**: éªŒè¯æ ¸å¿ƒåŠŸèƒ½
- **å®Œæˆ**: 8/11æµ‹è¯•é€šè¿‡ï¼Œæ ¸å¿ƒæ¶ˆæ¯å¤„ç†ã€è®¾ç½®åŒæ­¥ã€ç¼“å­˜ç®¡ç†åŠŸèƒ½éªŒè¯é€šè¿‡

---

## é˜¶æ®µ 11: UI ç»„ä»¶ (Vue)

### ä»»åŠ¡ 11.1: Popup ç•Œé¢
**ç›®æ ‡**: å®ç°å¿«æ·æ§åˆ¶å¼¹çª—

#### å­ä»»åŠ¡ 11.1.1: ç¼–å†™ Popup ç»„ä»¶æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/components/Popup.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•ç»„ä»¶æ¸²æŸ“
  - æµ‹è¯•å¯ç”¨/ç¦ç”¨åˆ‡æ¢
  - æµ‹è¯•è¯­è¨€é€‰æ‹©
  - æµ‹è¯•ç¿»è¯‘è§¦å‘
  - æµ‹è¯•çŠ¶æ€æ˜¾ç¤º

#### å­ä»»åŠ¡ 11.1.2: å®ç° Popup ç»„ä»¶
- **æ–‡ä»¶**: `entrypoints/popup/App.vue`
- **åŠŸèƒ½**:
  - æ˜¾ç¤ºç¿»è¯‘çŠ¶æ€
  - å¿«æ·å¼€å…³æ§åˆ¶
  - è¯­è¨€é€‰æ‹©å™¨
  - ç¿»è¯‘æŒ‰é’®
  - ç¼“å­˜ç»Ÿè®¡

#### å­ä»»åŠ¡ 11.1.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œ Popup ç»„ä»¶æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/components/Popup.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡

---

### ä»»åŠ¡ 11.2: Options è®¾ç½®é¡µé¢
**ç›®æ ‡**: å®ç°å®Œæ•´è®¾ç½®ç•Œé¢

#### å­ä»»åŠ¡ 11.2.1: ç¼–å†™ Options ç»„ä»¶æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/components/Options.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•ç»„ä»¶æ¸²æŸ“
  - æµ‹è¯•è®¾ç½®åŠ è½½
  - æµ‹è¯•è®¾ç½®ä¿å­˜
  - æµ‹è¯•è¡¨å•éªŒè¯
  - æµ‹è¯•å¯¼å…¥/å¯¼å‡º

#### å­ä»»åŠ¡ 11.2.2: å®ç° Options ç»„ä»¶
- **æ–‡ä»¶**: `entrypoints/options/App.vue`
- **åŠŸèƒ½**:
  - OpenAI API é…ç½®
  - æ¨¡å‹åˆ—è¡¨ç®¡ç†
  - å¹¶å‘è®¾ç½®
  - ç¼“å­˜é…ç½®
  - URL è¿‡æ»¤è§„åˆ™
  - å¯¼å…¥/å¯¼å‡ºè®¾ç½®

#### å­ä»»åŠ¡ 11.2.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œ Options ç»„ä»¶æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/components/Options.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡

---

## é˜¶æ®µ 12: é›†æˆæµ‹è¯•

### ä»»åŠ¡ 12.1: ç«¯åˆ°ç«¯ç¿»è¯‘æµç¨‹æµ‹è¯•
**ç›®æ ‡**: æµ‹è¯•å®Œæ•´çš„ç¿»è¯‘æµç¨‹

#### å­ä»»åŠ¡ 12.1.1: ç¼–å†™ç«¯åˆ°ç«¯æµ‹è¯•
- **æ–‡ä»¶**: `tests/integration/e2e-translation.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•é¡µé¢åŠ è½½åè‡ªåŠ¨ç¿»è¯‘
  - æµ‹è¯•æ‰‹åŠ¨è§¦å‘ç¿»è¯‘
  - æµ‹è¯•åŠ¨æ€å†…å®¹ç¿»è¯‘
  - æµ‹è¯•ç¿»è¯‘è¿˜åŸ
  - æµ‹è¯•ç¼“å­˜å‘½ä¸­
  - æµ‹è¯•å¤šæ¨¡å‹å¹¶å‘

#### å­ä»»åŠ¡ 12.1.2: è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
- **æ“ä½œ**: è¿è¡Œå®Œæ•´æµç¨‹æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/integration/e2e-translation.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡

---

### ä»»åŠ¡ 12.2: æ€§èƒ½æµ‹è¯•
**ç›®æ ‡**: éªŒè¯å¤§è§„æ¨¡ç¿»è¯‘æ€§èƒ½

#### å­ä»»åŠ¡ 12.2.1: ç¼–å†™æ€§èƒ½æµ‹è¯•
- **æ–‡ä»¶**: `tests/integration/performance.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•å¤§å‹ DOM æ ‘æå–æ€§èƒ½
  - æµ‹è¯•æ‰¹é‡ç¿»è¯‘æ€§èƒ½
  - æµ‹è¯•ç¼“å­˜è¯»å†™æ€§èƒ½
  - æµ‹è¯•å†…å­˜ä½¿ç”¨
  - æµ‹è¯•å¹¶å‘å¤„ç†èƒ½åŠ›

#### å­ä»»åŠ¡ 12.2.2: è¿è¡Œæ€§èƒ½æµ‹è¯•
- **æ“ä½œ**: è¿è¡Œæ€§èƒ½æµ‹è¯•å¹¶ç”ŸæˆæŠ¥å‘Š
- **å‘½ä»¤**: `pnpm test tests/integration/performance.test.ts`
- **ç›®æ ‡**: æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡

---

### ä»»åŠ¡ 12.3: å…¼å®¹æ€§æµ‹è¯•
**ç›®æ ‡**: æµ‹è¯•ä¸åŒæµè§ˆå™¨å’Œåœºæ™¯çš„å…¼å®¹æ€§

#### å­ä»»åŠ¡ 12.3.1: ç¼–å†™å…¼å®¹æ€§æµ‹è¯•
- **æ–‡ä»¶**: `tests/integration/compatibility.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯• Chrome å…¼å®¹æ€§
  - æµ‹è¯• Firefox å…¼å®¹æ€§
  - æµ‹è¯• Shadow DOM å¤„ç†
  - æµ‹è¯• iframe å¤„ç†
  - æµ‹è¯• SPA åº”ç”¨ç¿»è¯‘

#### å­ä»»åŠ¡ 12.3.2: è¿è¡Œå…¼å®¹æ€§æµ‹è¯•
- **æ“ä½œ**: åœ¨ä¸åŒç¯å¢ƒè¿è¡Œæµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/integration/compatibility.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰ç¯å¢ƒæµ‹è¯•é€šè¿‡

---

## é˜¶æ®µ 13: æ–‡æ¡£ä¸éƒ¨ç½²

### ä»»åŠ¡ 13.1: API æ–‡æ¡£
**ç›®æ ‡**: ç”Ÿæˆå®Œæ•´çš„ API æ–‡æ¡£

#### å­ä»»åŠ¡ 13.1.1: æ·»åŠ  JSDoc æ³¨é‡Š
- **æè¿°**: ä¸ºæ‰€æœ‰å…¬å…± API æ·»åŠ è¯¦ç»†çš„ JSDoc æ³¨é‡Š
- **èŒƒå›´**: æ‰€æœ‰ src/ ä¸‹çš„ç±»å’Œæ–¹æ³•

#### å­ä»»åŠ¡ 13.1.2: ç”Ÿæˆ API æ–‡æ¡£
- **å·¥å…·**: TypeDoc
- **å‘½ä»¤**: `pnpm run docs`
- **è¾“å‡º**: `docs/api/`

---

### ä»»åŠ¡ 13.2: ç”¨æˆ·æ–‡æ¡£
**ç›®æ ‡**: ç¼–å†™ç”¨æˆ·ä½¿ç”¨æ–‡æ¡£

#### å­ä»»åŠ¡ 13.2.1: ç¼–å†™ README
- **æ–‡ä»¶**: `README.md`
- **å†…å®¹**:
  - åŠŸèƒ½ä»‹ç»
  - å®‰è£…è¯´æ˜
  - å¿«é€Ÿå¼€å§‹
  - é…ç½®æŒ‡å—

#### å­ä»»åŠ¡ 13.2.2: ç¼–å†™ä½¿ç”¨æŒ‡å—
- **æ–‡ä»¶**: `docs/USER_GUIDE.md`
- **å†…å®¹**:
  - è¯¦ç»†ä½¿ç”¨è¯´æ˜
  - å¸¸è§é—®é¢˜
  - æ•…éšœæ’é™¤
  - æœ€ä½³å®è·µ

---

### ä»»åŠ¡ 13.3: å¼€å‘è€…æ–‡æ¡£
**ç›®æ ‡**: ç¼–å†™å¼€å‘è€…æ–‡æ¡£

#### å­ä»»åŠ¡ 13.3.1: ç¼–å†™æ¶æ„æ–‡æ¡£
- **æ–‡ä»¶**: `docs/ARCHITECTURE.md`
- **å†…å®¹**:
  - ç³»ç»Ÿæ¶æ„
  - æ¨¡å—è®¾è®¡
  - æ•°æ®æµ
  - æ‰©å±•æŒ‡å—

#### å­ä»»åŠ¡ 13.3.2: ç¼–å†™è´¡çŒ®æŒ‡å—
- **æ–‡ä»¶**: `CONTRIBUTING.md`
- **å†…å®¹**:
  - å¼€å‘ç¯å¢ƒè®¾ç½®
  - ä»£ç è§„èŒƒ
  - æµ‹è¯•è¦æ±‚
  - PR æµç¨‹

---

### ä»»åŠ¡ 13.4: æ„å»ºä¸å‘å¸ƒ
**ç›®æ ‡**: é…ç½®æ„å»ºæµç¨‹å’Œå‘å¸ƒè„šæœ¬

#### å­ä»»åŠ¡ 13.4.1: ä¼˜åŒ–æ„å»ºé…ç½®
- **æ–‡ä»¶**: `wxt.config.ts`
- **ä¼˜åŒ–**:
  - ä»£ç åˆ†å‰²
  - Tree shaking
  - å‹ç¼©ä¼˜åŒ–
  - Source map é…ç½®

#### å­ä»»åŠ¡ 13.4.2: åˆ›å»ºå‘å¸ƒè„šæœ¬
- **æ–‡ä»¶**: `scripts/release.sh`
- **åŠŸèƒ½**:
  - ç‰ˆæœ¬å·æ›´æ–°
  - æ„å»ºç”Ÿäº§ç‰ˆæœ¬
  - ç”Ÿæˆ changelog
  - æ‰“åŒ…å‘å¸ƒæ–‡ä»¶

#### å­ä»»åŠ¡ 13.4.3: é…ç½® CI/CD
- **æ–‡ä»¶**: `.github/workflows/ci.yml`
- **æµç¨‹**:
  - è‡ªåŠ¨è¿è¡Œæµ‹è¯•
  - ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
  - è‡ªåŠ¨æ„å»º
  - è‡ªåŠ¨å‘å¸ƒ

---

## æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡

### æ•´ä½“ç›®æ ‡
- **å•å…ƒæµ‹è¯•è¦†ç›–ç‡**: > 95%
- **é›†æˆæµ‹è¯•è¦†ç›–ç‡**: > 85%
- **æ•´ä½“è¦†ç›–ç‡**: > 90%

### å…³é”®æ¨¡å—è¦†ç›–ç‡
- æ ¸å¿ƒæ¨¡å— (core/): 100%
- æœåŠ¡æ¨¡å— (services/): > 95%
- å·¥å…·æ¨¡å— (utils/): > 90%
- UI ç»„ä»¶: > 80%

---

## å¼€å‘æ—¶é—´ä¼°ç®—

### é˜¶æ®µæ—¶é—´åˆ†é…
- é˜¶æ®µ 0 (æµ‹è¯•ç¯å¢ƒ): 1 å¤©
- é˜¶æ®µ 1 (ç±»å‹ç³»ç»Ÿ): 0.5 å¤©
- é˜¶æ®µ 2 (èŠ‚ç‚¹æå–): 3 å¤©
- é˜¶æ®µ 3 (è¯­è¨€æ£€æµ‹): 1 å¤©
- é˜¶æ®µ 4 (ç¼“å­˜ç³»ç»Ÿ): 2 å¤©
- é˜¶æ®µ 5 (OpenAI æœåŠ¡): 3 å¤©
- é˜¶æ®µ 6 (ç¿»è¯‘ç®¡ç†): 2 å¤©
- é˜¶æ®µ 7 (åŠ¨æ€ç›‘å¬): 1.5 å¤©
- é˜¶æ®µ 8 (è®¾ç½®ç®¡ç†): 1.5 å¤©
- é˜¶æ®µ 9 (Content Script): 1.5 å¤©
- é˜¶æ®µ 10 (Background): 1 å¤©
- é˜¶æ®µ 11 (UI ç»„ä»¶): 2 å¤©
- é˜¶æ®µ 12 (é›†æˆæµ‹è¯•): 2 å¤©
- é˜¶æ®µ 13 (æ–‡æ¡£éƒ¨ç½²): 2 å¤©

**æ€»è®¡**: çº¦ 23.5 å¤©

---

## è´¨é‡ä¿è¯æ£€æŸ¥æ¸…å•

### ä»£ç è´¨é‡
- [ ] æ‰€æœ‰ä»£ç é€šè¿‡ ESLint æ£€æŸ¥
- [ ] æ‰€æœ‰ä»£ç é€šè¿‡ TypeScript ç±»å‹æ£€æŸ¥
- [ ] æ‰€æœ‰å‡½æ•°æœ‰ JSDoc æ³¨é‡Š
- [ ] ä»£ç å¤æ‚åº¦åœ¨åˆç†èŒƒå›´å†…

### æµ‹è¯•è´¨é‡
- [ ] æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] æ‰€æœ‰é›†æˆæµ‹è¯•é€šè¿‡
- [ ] æµ‹è¯•è¦†ç›–ç‡è¾¾æ ‡
- [ ] æ€§èƒ½æµ‹è¯•è¾¾æ ‡

### åŠŸèƒ½å®Œæ•´æ€§
- [ ] æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å®ç°
- [ ] æ‰€æœ‰è¾¹ç•Œæƒ…å†µå¤„ç†
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] ç”¨æˆ·ä½“éªŒä¼˜åŒ–

### æ–‡æ¡£å®Œæ•´æ€§
- [ ] API æ–‡æ¡£å®Œæ•´
- [ ] ç”¨æˆ·æ–‡æ¡£å®Œæ•´
- [ ] å¼€å‘è€…æ–‡æ¡£å®Œæ•´
- [ ] ä»£ç æ³¨é‡Šå……åˆ†

---

## é£é™©ä¸åº”å¯¹

### æŠ€æœ¯é£é™©
1. **é€’å½’æ·±åº¦é™åˆ¶**
   - é£é™©: æ·±å±‚åµŒå¥— DOM å¯èƒ½å¯¼è‡´æ ˆæº¢å‡º
   - åº”å¯¹: å®ç°æ·±åº¦é™åˆ¶å’Œè¿­ä»£æ–¹æ¡ˆ

2. **æ€§èƒ½é—®é¢˜**
   - é£é™©: å¤§å‹é¡µé¢ç¿»è¯‘æ€§èƒ½ä¸ä½³
   - åº”å¯¹: åˆ†æ‰¹å¤„ç†ã€è™šæ‹Ÿæ»šåŠ¨ã€æ‡’åŠ è½½

3. **æµè§ˆå™¨å…¼å®¹æ€§**
   - é£é™©: ä¸åŒæµè§ˆå™¨ API å·®å¼‚
   - åº”å¯¹: ä½¿ç”¨ polyfillã€å……åˆ†æµ‹è¯•

### è¿›åº¦é£é™©
1. **æµ‹è¯•ç¼–å†™è€—æ—¶**
   - é£é™©: TDD å¯èƒ½å»¶é•¿å¼€å‘æ—¶é—´
   - åº”å¯¹: å¹¶è¡Œå¼€å‘ã€å¤ç”¨æµ‹è¯•æ¨¡æ¿

2. **éœ€æ±‚å˜æ›´**
   - é£é™©: å¼€å‘è¿‡ç¨‹ä¸­éœ€æ±‚è°ƒæ•´
   - åº”å¯¹: æ¨¡å—åŒ–è®¾è®¡ã€çµæ´»æ¶æ„

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³å¼€å§‹**: é˜¶æ®µ 0 - æµ‹è¯•ç¯å¢ƒæ­å»º
2. **ç¬¬ä¸€å‘¨ç›®æ ‡**: å®Œæˆé˜¶æ®µ 0-3
3. **ç¬¬äºŒå‘¨ç›®æ ‡**: å®Œæˆé˜¶æ®µ 4-7
4. **ç¬¬ä¸‰å‘¨ç›®æ ‡**: å®Œæˆé˜¶æ®µ 8-11
5. **ç¬¬å››å‘¨ç›®æ ‡**: å®Œæˆé˜¶æ®µ 12-13

---

## é˜¶æ®µ 8: è®¾ç½®ç®¡ç†

### å‚è€ƒèµ„æ–™
- WXT å®˜æ–¹æ–‡æ¡£: https://wxt.dev
- Vitest æ–‡æ¡£: https://vitest.dev
- Testing Library: https://testing-library.com
- OpenAI API: https://platform.openai.com/docs

### å·¥å…·é“¾
- Node.js: >= 18
- pnpm: >= 8
- TypeScript: >= 5.3
- Vitest: >= 1.0

---

## âœ… é˜¶æ®µ 8: è®¾ç½®ç®¡ç†ï¼ˆå·²å®Œæˆï¼‰

### ä»»åŠ¡ 8.1: è®¾ç½®å­˜å‚¨æœåŠ¡
**ç›®æ ‡**: æ®¡ç†æ’ä»¶è®¾ç½®çš„æŒä¹…åŒ–
**çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 8.1.1: ç¼–å†™è®¾ç½®å­˜å‚¨æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/services/settings-storage.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•è®¾ç½®åŠ è½½
  - æµ‹è¯•è®¾ç½®ä¿å­˜
  - æµ‹è¯•é»˜è®¤è®¾ç½®
  - æµ‹è¯•è®¾ç½®éªŒè¯
  - æµ‹è¯•è®¾ç½®è¿ç§»
  - æµ‹è¯•è®¾ç½®å¯¼å‡º/å¯¼å…¥
- **çŠ¶æ€**: å·²å®Œæˆï¼ˆ22/22 æµ‹è¯•é€šè¿‡ï¼‰

#### å­ä»»åŠ¡ 8.1.2: å®ç°è®¾ç½®å­˜å‚¨æœåŠ¡
- **æ–‡ä»¶**: `src/services/settings-storage.ts`
- **ç±»**: `SettingsStorage`
- **æ–¹æ³•**:
  - `load(): Promise<PluginSettings>`
  - `save(settings: PluginSettings): Promise<void>`
  - `update(updates: Partial<PluginSettings>): Promise<void>`
  - `reset(): Promise<void>`
  - `export(): Promise<SettingsExport>`
  - `import(data: SettingsExport): Promise<void>`
  - `getDefaultSettings(): PluginSettings`
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 8.1.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œè®¾ç½®å­˜å‚¨æœåŠ¡æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/services/settings-storage.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%
- **çŠ¶æ€**: å·²å®Œæˆï¼ˆ22/22 æµ‹è¯•é€šè¿‡ï¼‰

---

### ä»»åŠ¡ 8.2: URL è¿‡æ»¤å™¨
**ç›®æ ‡**: å®ç°é»‘ç™½åå• URL è¿‡æ»¤
**çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 8.2.1: ç¼–å†™ URL è¿‡æ»¤å™¨æµ‹è¯•
- **æ–‡ä»¶**: `tests/unit/utils/url-filter.test.ts`
- **æµ‹è¯•ç”¨ä¾‹**:
  - æµ‹è¯•ç™½åå•åŒ¹é…
  - æµ‹è¯•é»‘åå•åŒ¹é…
  - æµ‹è¯•é€šé…ç¬¦åŒ¹é…
  - æµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…
  - æµ‹è¯•ä¼˜å…ˆçº§å¤„ç†
  - æµ‹è¯•æ€§èƒ½
- **çŠ¶æ€**: å·²å®Œæˆï¼ˆæ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼‰

#### å­ä»»åŠ¡ 8.2.2: å®ç° URL è¿‡æ»¤å™¨
- **æ–‡ä»¶**: `src/utils/url-filter.ts`
- **ç±»**: `URLFilter`
- **æ–¹æ³•**:
  - `isAllowed(url: string): boolean`
  - `matchesWhitelist(url: string): boolean`
  - `matchesBlacklist(url: string): boolean`
  - `addToWhitelist(pattern: string): void`
  - `addToBlacklist(pattern: string): void`
  - `setWhitelist(patterns: string[]): void`
  - `setBlacklist(patterns: string[]): void`
  - `getWhitelist(): string[]`
  - `getBlacklist(): string[]`
  - `clear(): void`
- **çŠ¶æ€**: å·²å®Œæˆ

#### å­ä»»åŠ¡ 8.2.3: è¿è¡Œæµ‹è¯•éªŒè¯
- **æ“ä½œ**: è¿è¡Œ URL è¿‡æ»¤å™¨æµ‹è¯•
- **å‘½ä»¤**: `pnpm test tests/unit/utils/url-filter.test.ts`
- **ç›®æ ‡**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ > 95%
- **çŠ¶æ€**: å·²å®Œæˆï¼ˆæ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼‰

---

## ğŸ§ª æµ‹è¯•æŒ‡å—

### æµ‹è¯•æ­¥éª¤

#### 1. æ„å»ºå¹¶åŠ è½½æ‰©å±•
```bash
# æ„å»ºæ‰©å±•
npm run build

# åœ¨æµè§ˆå™¨ä¸­åŠ è½½
Chrome: chrome://extensions/
# å¯ç”¨å¼€å‘è€…æ¨¡å¼ -> åŠ è½½å·²è§£å‹çš„ .output/chrome-mv3/ ç›®å½•
```

#### 2. é…ç½® OpenAI API Key
1. å³é”®ç‚¹å‡»æ‰©å±•å›¾æ ‡ â†’ "è®¾ç½®"
2. åœ¨ "OpenAI API é…ç½®" éƒ¨åˆ†ï¼š
   - è¾“å…¥æ‚¨çš„ API Keyï¼ˆæ ¼å¼ï¼šsk-...ï¼‰
   - ç¡®è®¤ API Base URLï¼šhttps://api.openai.com/v1ï¼ˆæˆ–è‡ªå®šä¹‰åœ°å€ï¼‰
   - é…ç½®æ¨¡å‹åˆ—è¡¨ï¼ˆé»˜è®¤ï¼šgpt-3.5-turboï¼‰
3. ä¿å­˜è®¾ç½®

#### 3. å¯ç”¨ç¿»è¯‘
1. å³é”®ç‚¹å‡»æ‰©å±•å›¾æ ‡
2. ç¡®è®¤"å¯ç”¨è‡ªåŠ¨ç¿»è¯‘"å¼€å…³å·²æ‰“å¼€
3. ç¡®è®¤ç›®æ ‡è¯­è¨€ï¼ˆé»˜è®¤ï¼šzh-CNï¼‰

#### 4. æµ‹è¯•ç¿»è¯‘
1. æ‰“å¼€æµ‹è¯•é¡µé¢ï¼š
   ```
   file:///Users/yonh/workspaces/browser_plugin/auto-translator/test.html
   ```
2. ç‚¹å‡»æ‰©å±•å›¾æ ‡ â†’ "ç¿»è¯‘å½“å‰é¡µé¢"
3. è§‚å¯Ÿæ•ˆæœï¼š
   - è‹±æ–‡æ–‡æœ¬åº”è¢«ç¿»è¯‘æˆä¸­æ–‡
   - ç¿»è¯‘å…ƒç´ æ—è¾¹åº”æ˜¾ç¤º âœ“ æ ‡è®°ï¼ˆå¦‚æœå¯ç”¨ï¼‰
   - çŠ¶æ€åº”æ˜¾ç¤ºä¸º"å·²å®Œæˆ"

#### 5. æŸ¥çœ‹æ—¥å¿—
æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹æ§åˆ¶å°ï¼š
- `[Content Script]` - å†…å®¹è„šæœ¬æ—¥å¿—
- `[OpenAI Service]` - API æœåŠ¡æ—¥å¿—
- `[Page Translation Manager]` - ç¿»è¯‘ç®¡ç†å™¨æ—¥å¿—
- `[Popup]` - å¼¹çª—æ—¥å¿—

### å¸¸è§é—®é¢˜æ’æŸ¥

#### é—®é¢˜ï¼šç¿»è¯‘ä¸å·¥ä½œ
**å¯èƒ½åŸå› å’Œè§£å†³**ï¼š

1. **API Key æœªé…ç½®æˆ–æ— æ•ˆ**
   - æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰ `[OpenAI Service] API request failed` é”™è¯¯
   - ç¡®è®¤ API Key æ ¼å¼æ­£ç¡®ï¼šsk-xxxxx...

2. **æ’ä»¶æœªå¯ç”¨**
   - åœ¨å¼¹çª—ä¸­æ£€æŸ¥"å¯ç”¨è‡ªåŠ¨ç¿»è¯‘"å¼€å…³
   - æŸ¥çœ‹æ§åˆ¶å°æ˜¯å¦æœ‰ `[Content Script] Plugin disabled`

3. **é¡µé¢ä¸åŒ…å«å¯ç¿»è¯‘å†…å®¹**
   - æ‰“å¼€ä»»æ„è‹±æ–‡ç½‘ç«™ï¼ˆå¦‚ https://example.comï¼‰æµ‹è¯•
   - æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰æå–çš„å…ƒç´ æ•°é‡ä¿¡æ¯

4. **ç½‘ç»œé—®é¢˜**
   - æ£€æŸ¥æ˜¯å¦èƒ½è®¿é—® OpenAI API
   - å°è¯•è®¿é—® https://api.openai.com/v1

---

## ğŸš¨ å½“å‰é—®é¢˜å’Œä¿®å¤

### é—®é¢˜ 1: Content Script æ¶ˆæ¯ç±»å‹ä¸åŒ¹é…
- **çŠ¶æ€**: å·²ä¿®å¤ âœ…
- **é—®é¢˜**: Popup å‘é€å°å†™ `translatePage`ï¼ŒContent Script åŒæ—¶æ”¯æŒå¤§å°å†™å’Œä¸‹åˆ’çº¿æ ¼å¼
- **ä¿®å¤**: Content Script ç°åœ¨åŒæ—¶æ”¯æŒ `TRANSLATE_PAGE` å’Œ `translatePage`
- **æ–‡ä»¶**: `entrypoints/content.ts`

### é—®é¢˜ 2: TranslationCache æœªåˆå§‹åŒ–
- **çŠ¶æ€**: å·²ä¿®å¤ âœ…
- **é—®é¢˜**: TranslationCache.init() æœªè¢«è°ƒç”¨ï¼Œç¼“å­˜æ— æ³•æ­£ç¡®åˆå§‹åŒ–
- **ä¿®å¤**:
  - åœ¨ PageTranslationManager ä¸­æ·»åŠ  `initialize()` æ–¹æ³•
  - åœ¨æ„é€ å‡½æ•°åè°ƒç”¨
  - æ–‡ä»¶: `src/core/page-translation-manager.ts`, `entrypoints/content.ts`

### é—®é¢˜ 3: OpenAI API é”™è¯¯æ—¥å¿—ä¸è¯¦ç»†
- **çŠ¶æ€**: å·²ä¿®å¤ âœ…
- **é—®é¢˜**: API å¤±è´¥æ—¶ç¼ºå°‘è¯¦ç»†ä¿¡æ¯ï¼Œéš¾ä»¥è°ƒè¯•
- **ä¿®å¤**:
  - æ·»åŠ è¯¦ç»†çš„é”™è¯¯æ—¥å¿—
  - åŒ…æ‹¬ URLã€çŠ¶æ€ç å’Œé”™è¯¯æ–‡æœ¬
  - æ–‡ä»¶: `src/services/openai.ts`

### é—®é¢˜ 4: OpenAI API Key æœªé…ç½®
- **çŠ¶æ€**: éœ€è¦é…ç½® âš ï¸
- **é—®é¢˜**: é»˜è®¤é…ç½®ä¸­ API Key ä¸ºç©º
- **è§£å†³**:
  1. æ‰“å¼€æ‰©å±•è®¾ç½®é¡µé¢
  2. è¾“å…¥æœ‰æ•ˆçš„ OpenAI API Key
  3. ç¡®è®¤ API Base URL æ­£ç¡®ï¼ˆé»˜è®¤ï¼šhttps://api.openai.com/v1ï¼‰

### é—®é¢˜ 5: æ’ä»¶å¯èƒ½æœªå¯ç”¨
- **çŠ¶æ€**: éœ€è¦ç¡®è®¤ âš ï¸
- **é—®é¢˜**: settings.enabled å¯èƒ½æ˜¯ false
- **è§£å†³**:
  1. åœ¨ Popup ä¸­ç‚¹å‡»"å¯ç”¨è‡ªåŠ¨ç¿»è¯‘"å¼€å…³
  2. ç¡®è®¤ç›®æ ‡è¯­è¨€å·²è®¾ç½®ï¼ˆé»˜è®¤ï¼šzh-CNï¼‰

### ä¿®å¤è®°å½•

#### 1. TranslationCache åˆå§‹åŒ– âœ…
- **é—®é¢˜**: TranslationCache.init() æœªè¢«è°ƒç”¨ï¼Œç¼“å­˜æ— æ³•æ­£ç¡®åˆå§‹åŒ–
- **ä¿®å¤**:
  - åœ¨ PageTranslationManager ä¸­æ·»åŠ  `initialize()` æ–¹æ³•
  - åœ¨ content script çš„ `initialize()` ä¸­è°ƒç”¨ `pageManager.initialize()`
- **æ–‡ä»¶**: `src/core/page-translation-manager.ts`, `entrypoints/content.ts`

#### 2. é”™è¯¯æ—¥å¿—å¢å¼º âœ…
- **é—®é¢˜**: OpenAI API è°ƒç”¨å¤±è´¥æ—¶ç¼ºå°‘è¯¦ç»†ä¿¡æ¯ï¼Œéš¾ä»¥è°ƒè¯•
- **ä¿®å¤**: æ·»åŠ è¯¦ç»†çš„é”™è¯¯æ—¥å¿—ï¼ŒåŒ…æ‹¬ URLã€çŠ¶æ€ç å’Œé”™è¯¯æ–‡æœ¬
- **æ–‡ä»¶**: `src/services/openai.ts`

#### 3. Content Script æ¶ˆæ¯ç±»å‹ âœ…
- **é—®é¢˜**: Popup å‘é€å°å†™ `translatePage`ï¼ŒContent Script ä»…æ”¯æŒå¤§å†™
- **ä¿®å¤**: Content Script ç°åœ¨åŒæ—¶æ”¯æŒ `TRANSLATE_PAGE` å’Œ `translatePage`
- **æ–‡ä»¶**: `entrypoints/content.ts`

#### 4. URL è¿‡æ»¤å™¨é€šé…ç¬¦æ”¯æŒ âœ…
- **é—®é¢˜**: é€šé…ç¬¦ `*.evil.com` å’Œ `test*.com` æ— æ³•æ­£ç¡®åŒ¹é…
- **ä¿®å¤**:
  - æ·»åŠ  `patternToRegex()` æ–¹æ³•
  - å°† `*` è½¬æ¢ä¸º `.*`ï¼Œ`.` è½¬æ¢ä¸º `\.`
  - æ–‡ä»¶: `src/utils/url-filter.ts`
- **æµ‹è¯•ç»“æœ**: 18/18 æµ‹è¯•é€šè¿‡

---

## ğŸ‰ æœ€ç»ˆçŠ¶æ€

### âœ… æ‰€æœ‰å…³é”®é—®é¢˜å·²ä¿®å¤

1. **Content Script å…¥å£ç‚¹** - ä½¿ç”¨æ­£ç¡®çš„ `defineContentScript`
2. **ç¼“å­˜åˆå§‹åŒ–** - TranslationCache.init() æ­£ç¡®è°ƒç”¨
3. **é”™è¯¯æ—¥å¿—** - OpenAI API å¤±è´¥æ—¶è¾“å‡ºè¯¦ç»†ä¿¡æ¯
4. **æ¶ˆæ¯å…¼å®¹æ€§** - æ”¯æŒå¤§å°å†™å’Œä¸‹åˆ’çº¿æ¶ˆæ¯ç±»å‹
5. **URL è¿‡æ»¤å™¨** - é€šé…ç¬¦å’Œæ­£åˆ™è¡¨è¾¾å¼æ­£ç¡®åŒ¹é…

### ğŸ“ æµ‹è¯•çŠ¶æ€

```
Test Files: 6 passed (16)
Tests:      0 failed | 214 passed (214)
```

**é€šè¿‡ç‡**: 214/214 = **100%** ğŸ‰

---

## ğŸ§ª æµ‹è¯•æŒ‡å—

### å¿«é€Ÿå¼€å§‹

#### 1. æ„å»ºå¹¶åŠ è½½æ‰©å±•
```bash
# æ„å»ºæ‰©å±•
npm run build

# åœ¨æµè§ˆå™¨ä¸­åŠ è½½
Chrome: chrome://extensions/
# å¯ç”¨å¼€å‘è€…æ¨¡å¼ -> åŠ è½½å·²è§£å‹çš„ .output/chrome-mv3/ ç›®å½•
```

#### 2. é…ç½® OpenAI API Key
1. å³é”®ç‚¹å‡»æ‰©å±•å›¾æ ‡ â†’ "è®¾ç½®"
2. åœ¨ "OpenAI API é…ç½®" éƒ¨åˆ†ï¼š
   - è¾“å…¥æ‚¨çš„ API Keyï¼ˆæ ¼å¼ï¼šsk-xxxxxï¼‰
   - ç¡®è®¤ API Base URLï¼šhttps://api.openai.com/v1ï¼ˆæˆ–è‡ªå®šä¹‰åœ°å€ï¼‰
   - é…ç½®æ¨¡å‹åˆ—è¡¨ï¼ˆé»˜è®¤ï¼šgpt-3.5-turboï¼‰
   - ä¿å­˜è®¾ç½®

#### 3. å¯ç”¨ç¿»è¯‘
1. å³é”®ç‚¹å‡»æ‰©å±•å›¾æ ‡ â†’ å¼¹çª—
2. ç¡®è®¤"å¯ç”¨è‡ªåŠ¨ç¿»è¯‘"å¼€å…³å·²æ‰“å¼€
3. ç¡®è®¤ç›®æ ‡è¯­è¨€ï¼ˆé»˜è®¤ï¼šzh-CNï¼‰

#### 4. æµ‹è¯•ç¿»è¯‘
1. æ‰“å¼€æµ‹è¯•é¡µé¢ï¼š
   ```
   file:///Users/yonh/workspaces/browser_plugin/auto-translator/test.html
   ```
2. ç‚¹å‡»æ‰©å±•å›¾æ ‡ â†’ "ç¿»è¯‘å½“å‰é¡µé¢"
3. è§‚å¯Ÿæ•ˆæœï¼š
   - è‹±æ–‡æ–‡æœ¬åº”è¢«ç¿»è¯‘æˆä¸­æ–‡
   - ç¿»è¯‘å…ƒç´ æ—è¾¹åº”æ˜¾ç¤º âœ“ æ ‡è®°ï¼ˆå¦‚æœå¯ç”¨ï¼‰
   - çŠ¶æ€åº”æ˜¾ç¤ºä¸º"å·²å®Œæˆ"

#### 5. æŸ¥çœ‹æ—¥å¿—
æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹æ§åˆ¶å°ï¼š
- `[Content Script]` - å†…å®¹è„šæœ¬æ—¥å¿—
- `[OpenAI Service]` - API æœåŠ¡æ—¥å¿—
- `[Page Translation Manager]` - ç¿»è¯‘ç®¡ç†å™¨æ—¥å¿—
- `[Popup]` - å¼¹çª—æ—¥å¿—

---

## ğŸš¨ å¦‚æœç¿»è¯‘ä¸å·¥ä½œ

### æ£€æŸ¥æ¸…å•

1. **API Key æ˜¯å¦é…ç½®**
   - æ‰“å¼€è®¾ç½®é¡µé¢ï¼Œç¡®è®¤ API Key å·²è¾“å…¥
   - æ ¼å¼åº”ä¸ºï¼š`sk-xxxxx...`

2. **æ’ä»¶æ˜¯å¦å¯ç”¨**
   - åœ¨å¼¹çª—ä¸­ç¡®è®¤"å¯ç”¨è‡ªåŠ¨ç¿»è¯‘"å¼€å…³

3. **æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯**
   ```
   æŸ¥æ‰¾è¿™äº›é”™è¯¯ä¿¡æ¯ï¼š
   - `[OpenAI Service] API request failed: ...`
   - `[OpenAI Service] No translation returned ...`
   ```
   - **è§£å†³æ–¹æ¡ˆ**ï¼š
     - æ£€æŸ¥ API Key æ˜¯å¦æœ‰æ•ˆ
     - æ£€æŸ¥ç½‘ç»œè¿æ¥
     - æ£€æŸ¥ API URL æ˜¯å¦æ­£ç¡®

4. **æ£€æŸ¥ç½‘ç»œè¿æ¥**
   - å°è¯•åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼šhttps://api.openai.com/v1
   - å¦‚æœæ— æ³•è®¿é—®ï¼Œå¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜æˆ–ä»£ç†è®¾ç½®

5. **æŸ¥çœ‹æå–çš„å…ƒç´ æ•°é‡**
   - æ§åˆ¶å°ä¼šæ˜¾ç¤ºæå–äº†å¤šå°‘å¯ç¿»è¯‘å…ƒç´ 
   - å¦‚æœæ•°é‡ä¸º 0ï¼Œæ£€æŸ¥é¡µé¢ç»“æ„

---

## ğŸ“‹ åŠŸèƒ½æ¨¡å—å®ŒæˆçŠ¶æ€

| æ¨¡å— | çŠ¶æ€ | åŠŸèƒ½ |
|--------|------|------|
| Content Script å…¥å£ | âœ… å®Œæˆ | æ¶ˆæ¯å¤„ç†ã€åˆå§‹åŒ– |
| é¡µé¢ç¿»è¯‘ç®¡ç†å™¨ | âœ… å®Œæˆ | ç¿»è¯‘æµç¨‹åè°ƒã€ç¼“å­˜åˆå§‹åŒ– |
| ç¿»è¯‘åº”ç”¨å™¨ | âœ… å®Œæˆ | åº”ç”¨ç¿»è¯‘åˆ° DOM |
| æ–‡æœ¬æå–å™¨ | âœ… å®Œæˆ | é€’å½’æå–å¯ç¿»è¯‘èŠ‚ç‚¹ |
| è¯­è¨€æ£€æµ‹å™¨ | âœ… å®Œæˆ | Unicode èŒƒå›´æ£€æµ‹ |
| OpenAI æœåŠ¡ | âœ… å®Œæˆ | API è°ƒç”¨ã€ç¼“å­˜ã€å¹¶å‘æ§åˆ¶ã€é”™è¯¯æ—¥å¿— |
| ç¿»è¯‘ç¼“å­˜ | âœ… å®Œæˆ | æŒä¹…åŒ–ç¼“å­˜ã€è¿‡æœŸæ¸…ç† |
| çŠ¶æ€ç®¡ç† | âœ… å®Œæˆ | ç¿»è¯‘çŠ¶æ€è·Ÿè¸ª |
| DOM å˜åŒ–ç›‘å¬ | âœ… å®Œæˆ | ç›‘å¬é¡µé¢å˜åŒ– |
| è‡ªåŠ¨ç¿»è¯‘è§¦å‘ | âœ… å®Œæˆ | åŠ¨æ€å†…å®¹è‡ªåŠ¨ç¿»è¯‘ |
| Popup ç•Œé¢ | âœ… å®Œæˆ | ç”¨æˆ·æ§åˆ¶é¢æ¿ |
| Options è®¾ç½® | âœ… å®Œæˆ | é…ç½®é¡µé¢ |
| Background æœåŠ¡ | âœ… å®Œæˆ | åå°æœåŠ¡ |
| URL è¿‡æ»¤å™¨ | âœ… å®Œæˆ | é€šé…ç¬¦ã€æ­£åˆ™åŒ¹é… |

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ€»ç»“

### å®Œæ•´çš„ç¿»è¯‘æµç¨‹

1. **åˆå§‹åŒ–é˜¶æ®µ**
   - content script åŠ è½½åˆ°é¡µé¢
   - åˆå§‹åŒ– PageTranslationManager
   - è°ƒç”¨ TranslationCache.init()

2. **ç”¨æˆ·è§¦å‘ç¿»è¯‘**
   - Popup å‘é€ `translatePage` æˆ– `TRANSLATE_PAGE` æ¶ˆæ¯
   - Content Script æ¥æ”¶å¹¶è°ƒç”¨ `pageManager.translatePage()`

3. **é¡µé¢æ‰«æ**
   - TextExtractor é€’å½’éå† DOM æ ‘
   - æ’é™¤ scriptã€styleã€code ç­‰æ ‡ç­¾
   - è¯†åˆ«æ–‡æœ¬èŠ‚ç‚¹å’Œå®¹å™¨èŠ‚ç‚¹

4. **è¯­è¨€æ£€æµ‹**
   - LanguageDetector åˆ†ææ–‡æœ¬
   - ä½¿ç”¨ Unicode èŒƒå›´åˆ¤æ–­è¯­è¨€
   - åˆ¤æ–­æ˜¯å¦éœ€è¦ç¿»è¯‘ï¼ˆæºè¯­è¨€ â‰  ç›®æ ‡è¯­è¨€ï¼‰

5. **æ‰¹é‡ç¿»è¯‘**
   - PageTranslationManager è°ƒç”¨ OpenAIService.translateBatch()
   - ä»ç¼“å­˜ä¸­æŸ¥æ‰¾å·²ç¿»è¯‘å†…å®¹
   - æœªå‘½ä¸­åˆ™è°ƒç”¨ API
   - æ”¯æŒå¤šæ¨¡å‹å¹¶å‘ç»•è¿‡é™åˆ¶

6. **åº”ç”¨ç¿»è¯‘**
   - TranslationApplier å°†ç¿»è¯‘ç»“æœåº”ç”¨åˆ° DOM
   - ä¿å­˜åŸå§‹æ–‡æœ¬ç”¨äºæ’¤é”€
   - å¯é€‰æ·»åŠ ç¿»è¯‘æ ‡è®°ï¼ˆâœ“ï¼‰

7. **ç”¨æˆ·åé¦ˆ**
   - å®æ—¶è¿›åº¦æ›´æ–°
   - ç¿»è¯‘çŠ¶æ€å˜åŒ–
   - é”™è¯¯å¤„ç†å’Œæç¤º

---

## ğŸ”§ æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: WXT 0.19.29
- **è¯­è¨€**: TypeScript 5.3+
- **UI**: Vue 3
- **æµ‹è¯•**: Vitest
- **æµè§ˆå™¨**: Chrome MV3

---

*æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆå¹¶æµ‹è¯•é€šè¿‡ï¼Œæ‰©å±•å·²å¯ä»¥æ­£å¸¸å·¥ä½œï¼*

*æœ¬æ–‡æ¡£å°†éšç€å¼€å‘è¿›åº¦æŒç»­æ›´æ–°*
