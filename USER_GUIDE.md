# 使用指南

## 🚀 快速开始

### 1. 安装插件

1. 解压 `auto-translator-1.0.0-chrome.zip`
2. 打开 Chrome/Edge:
   ```
   chrome://extensions/
   ```
3. 开启右上角"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择解压后的 `chrome-mv3` 文件夹

### 2. 配置插件

#### 步骤 1: 打开设置

1. 点击浏览器工具栏的 Auto Translator 图标
2. 点击"设置"按钮

#### 步骤 2: 配置 OpenAI API

在"OpenAI API 配置"区域：
1. 输入 API 密钥（如 `sk-xxxxxxxxxxxxx`）
2. 输入 API 地址（默认是 `https://api.openai.com/v1`）
3. 配置模型列表（每行一个模型）

**示例配置**:
```
gpt-3.5-turbo
gpt-4
gpt-4-turbo-preview
```

**多模型并发**（重要功能）:
- 配置多个模型可以绕过单模型并发限制
- 例如：3 个模型 × 5 并发 = 总共 15 并发能力

4. 设置最大并发数（建议 5-20）
5. 点击"保存设置"

#### 步骤 3: 其他设置

- **目标语言**: 选择你要翻译成的语言
- **自动检测语言**: 建议开启
- **启用翻译缓存**: 建议开启以减少 API 调用
- **URL 过滤**: 根据需要配置黑白名单

### 3. 使用翻译

#### 方法 1: 自动翻译

1. 访问任意正常网页（如 https://google.com）
2. 插件会自动检测页面语言
3. 如果需要翻译，会自动开始翻译
4. 等待翻译完成

#### 方法 2: 手动翻译

1. 访问正常网页
2. 点击插件图标打开 Popup
3. 点击"翻译当前页面"按钮
4. 等待翻译完成

### 4. 查看翻译结果

- 翻译后的文本会直接显示在页面上
- 每个翻译的元素会有蓝色标记图标
- 点击标记图标可以还原原文

## ⚙️ 高级功能

### 配置导入导出

#### 导出配置

1. 打开设置页面
2. 滚动到底部"配置管理"区域
3. 点击"导出配置"按钮
4. 配置文件会自动下载为 JSON 格式

#### 导入配置

1. 打开设置页面
2. 点击"导入配置"按钮
3. 选择之前导出的 JSON 文件
4. 确认导入成功

**用途**:
- 备份当前配置
- 在不同设备间同步配置
- 快速恢复默认设置

### 多模型并发（绕过限制）

**原理**:
每个 OpenAI 模型都有独立的并发限制。通过配置多个模型，插件会自动将请求分配到不同模型，从而绕过单模型限制。

**配置示例**:

```
gpt-3.5-turbo        # 模型 1
gpt-3.5-turbo-16k   # 模型 2
gpt-4                 # 模型 3
gpt-4-turbo-preview   # 模型 4
```

**并发计算**:
- 配置：4 个模型，最大并发 20
- 实际：每个模型 5 并发 = 总共 20 并发请求
- 对比：如果只用 1 个模型，最多只能 5 并发

**适用场景**:
- 批量翻译大量文本
- 多页面同时翻译
- 提高翻译速度

### URL 过滤

#### 白名单模式

只翻译白名单中的网站：

```
github.com
stackoverflow.com
medium.com
```

#### 黑名单模式

不翻译黑名单中的网站：

```
translate.google.com
deepl.com
google.com/translate
```

### 缓存管理

- 查看缓存统计：设置页面底部
- 手动清除缓存：点击"清除缓存"按钮
- 缓存有效期：可配置 1-30 天

## 🐛 故障排除

### 问题 1: 提示"请在正常网页上使用翻译功能"

**原因**: 在扩展设置页或新标签页打开了 Popup

**解决**:
1. 访问一个正常网页（如 https://example.com）
2. 刷新页面确保完全加载
3. 重新打开 Popup
4. 点击"翻译当前页面"

### 问题 2: 显示"无法连接到页面"

**原因**: Content script 未加载或页面正在刷新

**解决**:
1. 刷新当前页面 (F5)
2. 等待页面完全加载
3. 重新点击翻译按钮
4. 如果仍不行，重新加载插件

### 问题 3: API 密钥配置但仍然提示未配置

**原因**: 配置可能没有正确保存或验证逻辑有问题

**解决**:
1. 重新打开设置页面
2. 重新输入 API 密钥
3. 确保没有前后空格
4. 保存设置
5. 刷新页面
6. 重新测试

### 问题 4: 翻译后没有显示

**原因**: 可能是以下之一：
- API 请求失败
- 目标语言与源语言相同
- 内容被排除

**解决**:
1. 打开浏览器控制台 (F12)
2. 查看错误信息
3. 检查 API 密钥是否有效
4. 确认目标语言设置正确

### 问题 5: 部分内容未翻译

**原因**:
- 动态加载的内容
- 某些元素被排除（script, style 等）
- 翻译超时

**解决**:
- 滚动页面或等待页面完全加载
- 重新点击"翻译当前页面"
- 检查是否有错误信息

## 🔧 调试工具

在网页控制台使用调试命令：

```javascript
// 检查所有模块状态
window.__DEBUG__.healthCheck();

// 测试单个翻译
window.__DEBUG__.testTranslation();

// 测试批量翻译
window.__DEBUG__.testBatchTranslation();

// 查看帮助
window.__DEBUG__.showHelp();
```

**调试输出示例**:

```
=== Auto Translator Health Check ===
Timestamp: 2024-01-23T00:00:00.000Z

--- Modules ---
translationManager: ✓
languageDetector: ✓
openaiService: ✓
translationCache: ✓

--- Settings ---
Settings loaded: true
Plugin enabled: true
Target language: zh-CN
API Key configured: true
Models: ["gpt-3.5-turbo", "gpt-4"]
Max concurrency: 15

--- Cache ---
Cache entries: 0
Oldest entry: -
Newest entry: -

--- Page ---
Detected language: en
URL: https://example.com

=========================
```

## 📊 性能优化建议

### 1. 使用多模型并发

配置多个模型可以大幅提高翻译速度，特别是在：
- 批量翻译时
- 多页面同时翻译时
- 翻译大量文本时

### 2. 启用缓存

缓存功能可以：
- 减少重复 API 调用
- 降低 API 使用成本
- 提高翻译速度（命中缓存时）

### 3. 合理设置并发数

- 单模型：建议 5-10
- 多模型：建议每个模型 3-5
- 总并发：建议不超过 20

### 4. 选择合适的模型

- **快速翻译**: `gpt-3.5-turbo`
- **高质量翻译**: `gpt-4`
- **平衡方案**: 同时配置多个模型

## 🔒 安全建议

### 1. 保护 API 密钥

- ✅ 不要分享配置文件
- ✅ 不要在公共场所讨论 API 密钥
- ✅ 定期轮换 API 密钥
- ✅ 使用专用的 API 密钥（不要与其他应用共享）

### 2. 检查配置文件

导入配置前检查：
- 文件来源是否可信
- 文件内容是否合理
- API 密钥是否仍然有效

### 3. 浏览器扩展权限

- 只授予必要的权限
- 定期检查扩展列表
- 只从可信来源安装扩展

## 📝 常见问题

### Q: 支持哪些 API 服务商？

A: 支持所有 OpenAI 兼容的 API：
- OpenAI 官方 API
- Azure OpenAI
- DeepSeek (国产)
- 通义千问
- 智谱 GLM
- 其他兼容接口

### Q: 多模型并发会增加 API 成本吗？

A: 不会显著增加成本，因为：
- 相同的文本会被缓存
- 只翻译新的内容
- 可以根据需要选择不同的模型

### Q: 可以翻译图片吗？

A: 当前版本不支持图片翻译，只能翻译文本。

### Q: 可以翻译 PDF 文档吗？

A: 当前版本不支持，但可以：
- 将 PDF 复制为文本后翻译
- 或使用专门的 PDF 翻译工具

### Q: 翻译后的文本可以导出吗？

A: 当前版本不支持导出，但可以：
- 手动复制翻译后的文本
- 或使用浏览器翻译功能导出

### Q: 插件会收集我的数据吗？

A: 不会。插件：
- 不会收集用户数据
- 翻译文本只发送到配置的 API 服务器
- 缓存在浏览器本地存储
- 不上传到任何服务器

## 🎯 最佳实践

### 1. 配置建议

**初学者**:
```
模型: gpt-3.5-turbo
并发数: 5
缓存: 启用
自动检测: 启用
```

**进阶用户**:
```
模型: 
  gpt-3.5-turbo
  gpt-3.5-turbo-16k
  gpt-4-turbo-preview
并发数: 15-20
缓存: 启用（7天）
自动检测: 启用
```

### 2. 使用建议

1. **首次使用**: 在简单页面测试（如博客文章）
2. **批量翻译**: 配置多模型并发
3. **日常使用**: 保持合理的并发数
4. **API 限流**: 出现 429 错误时，降低并发数或等待

### 3. 监控建议

- 定期查看 API 使用情况
- 检查缓存命中率
- 关注错误日志
- 根据使用情况优化配置

## 📞 获取帮助

### 官方文档

- README.md - 项目简介
- INSTALL.md - 详细安装说明
- CONFIG_EXAMPLES.md - 配置示例
- IMPORT_EXPORT.md - 导入导出说明
- DEBUG.md - 调试指南
- QUICK_FIX.md - 快速修复指南
- BUG_FIXES.md - Bug 修复记录

### 调试工具

使用内置的调试工具诊断问题：

```javascript
window.__DEBUG__.healthCheck();
window.__DEBUG__.showHelp();
```

### 反馈渠道

如果遇到文档中未提到的问题：

1. 收集完整信息：
   - 浏览器版本
   - 操作系统
   - 插件版本
   - 错误信息
   - 控制台日志
   - 复现步骤

2. 查看已有的 Issue

3. 提交新的 Issue（如果适用）

---

**版本**: 1.0.5
**更新日期**: 2024-01-23
**状态**: ✅ 所有功能已测试
